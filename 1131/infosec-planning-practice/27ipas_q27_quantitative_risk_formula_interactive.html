<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iPAS 資訊安全規劃實務 - 第 27 題互動教學</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --accent-color: #3498db;
            --success-color: #27ae60;
            --error-color: #c0392b;
            --bg-color: #fdfdfd;
            --box-bg: #f8f9fa;
            --highlight-bg: #fffbe6;
            --border-color: #bdc3c7;
            --text-color: #333;
            --font-size-base: 16px;
            --font-size-header: 18px; /* max 1 level larger */
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: "Noto Sans TC", "Microsoft JhengHei", Arial, sans-serif;
            background-color: #eaeff2;
            color: var(--text-color);
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            font-size: var(--font-size-base);
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        header {
            border-bottom: 2px solid var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
        }

        h1, h2, h3 {
            color: var(--primary-color);
            margin-top: 1.5em;
            margin-bottom: 0.5em;
            font-size: var(--font-size-header);
            font-weight: 700;
        }

        h1 {
            margin-top: 0;
            text-align: center;
        }

        .question-box {
            background-color: var(--box-bg);
            border: 1px solid var(--border-color);
            padding: 20px;
            border-radius: 4px;
            margin-bottom: 20px;
        }

        .question-text {
            font-weight: 500;
            margin-bottom: 20px;
            white-space: pre-line;
        }

        .options-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option-label {
            display: flex;
            align-items: center;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .option-label:hover {
            background-color: var(--highlight-bg);
        }

        .option-label input[type="radio"] {
            margin-right: 12px;
            transform: scale(1.2);
        }

        .controls {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        button {
            padding: 10px 20px;
            font-size: var(--font-size-base);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        button:hover {
            opacity: 0.9;
        }

        #submit-btn {
            background-color: var(--accent-color);
            color: white;
        }

        #reset-btn {
            background-color: #95a5a6;
            color: white;
        }

        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 4px;
            font-weight: bold;
            display: none;
            text-align: center;
        }

        .feedback.correct {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .feedback.wrong {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        /* Cram school style notes */
        .explanation-section {
            display: none; /* Hidden by default */
            margin-top: 30px;
            border-top: 2px dashed var(--border-color);
            padding-top: 20px;
        }

        .note-box {
            background-color: var(--highlight-bg);
            border-left: 5px solid var(--accent-color);
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 4px 4px 0;
        }

        .note-title {
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 8px;
            display: block;
        }

        .key-point {
            font-weight: bold;
            color: #d35400;
        }

        .analysis-item {
            margin-bottom: 10px;
            padding-left: 10px;
            border-left: 3px solid #ddd;
        }

        .toggle-answer-btn {
            background-color: var(--primary-color);
            color: white;
            font-size: 0.9em;
            padding: 5px 10px;
            margin-left: 10px;
        }

        .hidden-answer {
            visibility: hidden;
            font-weight: bold;
            color: var(--accent-color);
        }

        .visible-answer {
            visibility: visible;
        }

        ul {
            padding-left: 20px;
            margin: 10px 0;
        }

        li {
            margin-bottom: 6px;
        }

        /* Print styles */
        @media print {
            body { background: white; }
            .container { box-shadow: none; width: 100%; max-width: 100%; }
            .explanation-section { display: block !important; }
            button { display: none; }
        }

        /* Mobile adaptation */
        @media (max-width: 600px) {
            .container { padding: 15px; }
            .controls { flex-direction: column; }
            button { width: 100%; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>iPAS 資訊安全規劃實務 - 重點試題解析</h1>
        <p style="text-align: center; color: #666; font-size: 0.9em;">題型：風險量化分析公式理解</p>
    </header>

    <main>
        <div class="question-box">
            <div class="question-text">
                27. 風險分析的其中一個用以詮釋量化計算公式，包含
                「單一損失預期值」（Single Loss Expectancy，SLE）、
                「年度發生比率」（Annual Rate of Occurrence，ARO），
                以及「年度損失預期值」（Annual Loss Expectancy，ALE），
                請問三者的關係為下列何項？
            </div>
            
            <div class="options-group">
                <label class="option-label">
                    <input type="radio" name="q27" value="A">
                    <span>(A) ALE = ARO × SLE</span>
                </label>
                <label class="option-label">
                    <input type="radio" name="q27" value="B">
                    <span>(B) ARO = ALE × SLE</span>
                </label>
                <label class="option-label">
                    <input type="radio" name="q27" value="C">
                    <span>(C) ALE = ARO ÷ SLE</span>
                </label>
                <label class="option-label">
                    <input type="radio" name="q27" value="D">
                    <span>(D) ARO = SLE ÷ ALE</span>
                </label>
            </div>
        </div>

        <div class="controls">
            <button id="submit-btn" onclick="checkAnswer()">提交答案</button>
            <button id="reset-btn" onclick="resetQuiz()">重作本題</button>
        </div>

        <div id="feedback-msg" class="feedback"></div>

        <!-- 解析區塊 -->
        <div id="explanation" class="explanation-section">
            
            <h2>【詳細解析】</h2>

            <div class="note-box">
                <span class="note-title">【第一步：找關鍵字】</span>
                <ul>
                    <li><span class="key-point">量化風險分析</span>（定量計算）</li>
                    <li>SLE（單次損失）</li>
                    <li>ARO（一年發生幾次）</li>
                    <li>ALE（一年預期損失）</li>
                </ul>
            </div>

            <div class="note-box">
                <span class="note-title">【第二步：白話翻譯】</span>
                <p>用生活例子說明：<br>
                <strong>「一年會發生幾次事故」×「每次會損失多少錢」=「一年總共損失多少錢」</strong></p>
            </div>

            <h3>【第三步：解題思路】</h3>
            <ul>
                <li><strong>這題在考什麼觀念？</strong> 定量風險分析的基礎數學關係。</li>
                <li><strong>解題步驟：</strong>
                    <ol>
                        <li>先搞懂每個名詞「單位」是什麼。</li>
                        <li>判斷哪一個是「一次」、哪一個是「一年」。</li>
                        <li>推導一年總損失的計算方式。</li>
                    </ol>
                </li>
                <li><strong>原理與規則：</strong> 為什麼年度損失一定是「次數 × 每次損失」？因為這是累積的概念。</li>
            </ul>

            <h3>【第四步：選項分析】</h3>
            <div class="analysis-item">
                <strong>(A) ALE = ARO × SLE</strong><br>
                <span style="color:var(--success-color)">正確。</span>
                年度預期損失 = 年度發生率 × 單一損失預期值。<br>
                (單位檢驗：元/年 = 次/年 × 元/次)
            </div>
            <div class="analysis-item">
                <strong>(B) ARO = ALE × SLE</strong><br>
                <span style="color:var(--error-color)">錯誤。</span>
                這變成「發生次數 = 年度損失 × 單次損失」，金額乘金額會變成平方，單位不合理。
            </div>
            <div class="analysis-item">
                <strong>(C) ALE = ARO ÷ SLE</strong><br>
                <span style="color:var(--error-color)">錯誤。</span>
                將乘法誤寫成除法。次數除以金額無法得出總金額。
            </div>
            <div class="analysis-item">
                <strong>(D) ARO = SLE ÷ ALE</strong><br>
                <span style="color:var(--error-color)">錯誤。</span>
                這變成「次數 = 單次損失 ÷ 年度損失」，通常年度損失會大於單次損失，這樣除出來次數會變小數點，邏輯容易混淆且不直觀。
            </div>

            <hr style="border: 0; border-top: 1px solid #ddd; margin: 20px 0;">

            <h3>【觀念補充與延伸】</h3>
            <div class="note-box">
                <span class="note-title">核心觀念定位</span>
                iPAS 資訊安全規劃實務 → 風險分析（量化）
            </div>
            
            <p><strong>名詞定義：</strong></p>
            <ul>
                <li><strong>SLE (Single Loss Expectancy)：</strong>一次事件會造成多少損失（資產價值 × 暴露因子）。</li>
                <li><strong>ARO (Annual Rate of Occurrence)：</strong>一年大約會發生幾次（頻率）。</li>
                <li><strong>ALE (Annual Loss Expectancy)：</strong>一年預期會損失多少（用來評估該花多少錢做防護）。</li>
            </ul>

            <p><strong>對比概念：</strong></p>
            <ul>
                <li><strong>定性風險分析 (Qualitative)：</strong>用高、中、低或紅綠燈等級來描述風險，主觀性較強。</li>
                <li><strong>定量風險分析 (Quantitative)：</strong>用具體的數字、金額來描述風險，客觀但計算較耗時。</li>
            </ul>

            <div class="note-box" style="background-color: #e8f6f3; border-left-color: #1abc9c;">
                <span class="note-title">【記憶口訣】</span>
                <span style="font-size: 1.1em; font-weight: bold;">「一年損失 = 一次損失 × 一年次數」</span>
            </div>

            <p><strong>常見陷阱：</strong></p>
            <ul>
                <li>把 ARO 當成金額（它是次數/頻率）。</li>
                <li>把 SLE 當成一年總損失（它是單次）。</li>
                <li>看到公式就死背，不管單位。</li>
            </ul>

            <h3>【正確答案】</h3>
            <p>答案：<strong>(A)</strong></p>
            <p>一句話理由：一年會發生幾次 × 每次損失多少 = 一年預期損失。</p>

            <div class="note-box" style="background-color: #f4ecf7; border-left-color: #9b59b6;">
                <span class="note-title">【自我檢測】</span>
                <p>
                    1. 如果 SLE 是 10 萬、ARO 是 2，ALE 是多少？
                    <button class="toggle-answer-btn" onclick="toggleAnswer('ans1')">看答案</button>
                    <span id="ans1" class="hidden-answer">20 萬 (10萬 × 2)</span>
                </p>
                <p>
                    2. 如果 ALE 是 50 萬、ARO 是 5，可以反推出 SLE 嗎？
                    <button class="toggle-answer-btn" onclick="toggleAnswer('ans2')">看答案</button>
                    <span id="ans2" class="hidden-answer">可以，SLE 為 10 萬 (50萬 ÷ 5)</span>
                </p>
            </div>

        </div>
    </main>
</div>

<script>
    function checkAnswer() {
        const selectedOption = document.querySelector('input[name="q27"]:checked');
        const feedbackEl = document.getElementById('feedback-msg');
        const explanationEl = document.getElementById('explanation');
        
        if (!selectedOption) {
            alert('請先選擇一個答案！');
            return;
        }

        const answer = selectedOption.value;
        
        // Remove previous classes
        feedbackEl.classList.remove('correct', 'wrong');
        feedbackEl.style.display = 'block';

        if (answer === 'A') {
            feedbackEl.textContent = '恭喜答對！正確答案是 (A)';
            feedbackEl.classList.add('correct');
        } else {
            feedbackEl.textContent = '答錯了，正確答案是 (A)。請參考下方解析。';
            feedbackEl.classList.add('wrong');
        }

        // Show explanation regardless of right or wrong
        explanationEl.style.display = 'block';
        
        // Scroll to feedback
        feedbackEl.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    function resetQuiz() {
        // Clear radio buttons
        const radios = document.querySelectorAll('input[name="q27"]');
        radios.forEach(radio => radio.checked = false);

        // Hide feedback and explanation
        document.getElementById('feedback-msg').style.display = 'none';
        document.getElementById('explanation').style.display = 'none';

        // Hide self-check answers
        document.getElementById('ans1').className = 'hidden-answer';
        document.getElementById('ans2').className = 'hidden-answer';

        // Scroll to top
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function toggleAnswer(id) {
        const el = document.getElementById(id);
        if (el.classList.contains('hidden-answer')) {
            el.className = 'visible-answer';
        } else {
            el.className = 'hidden-answer';
        }
    }
</script>

</body>
</html>