<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iPAS è³‡å®‰è¦åŠƒå¯¦å‹™è¡åˆº - ç¬¬33é¡Œäº’å‹•æ•™å­¸</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --accent-color: #3498db;
            --success-color: #27ae60;
            --error-color: #c0392b;
            --warning-color: #f39c12;
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --text-color: #333333;
            --border-radius: 8px;
            --spacing: 1.5rem;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: "Noto Sans TC", "Microsoft JhengHei", sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--bg-color);
            font-size: 16px;
            padding-bottom: 2rem;
        }

        /* Layout Utilities */
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: var(--spacing);
            margin-bottom: var(--spacing);
        }

        /* Header */
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            text-align: center;
        }

        header h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            font-weight: 300;
        }

        .meta-info {
            margin-top: 1rem;
            display: inline-block;
            background: rgba(255,255,255,0.1);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        /* Progress Bar */
        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 4px;
            background: var(--success-color);
            width: 0%;
            transition: width 0.3s;
            z-index: 1000;
        }

        /* Stats Panel */
        .stats-panel {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            color: #666;
        }

        .btn-text {
            background: none;
            border: none;
            color: var(--accent-color);
            cursor: pointer;
            text-decoration: underline;
            font-size: 0.9rem;
        }

        /* Quiz Area */
        .question-text {
            font-size: 1.25rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
            color: var(--primary-color);
        }

        .question-type {
            display: inline-block;
            background: var(--warning-color);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.8rem;
            margin-right: 8px;
            vertical-align: middle;
        }

        .options-list {
            list-style: none;
        }

        .option-item {
            margin-bottom: 0.8rem;
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: flex-start;
        }

        .option-item:hover {
            border-color: var(--accent-color);
            background-color: #f0f7fb;
        }

        .option-item.selected {
            border-color: var(--accent-color);
            background-color: #eaf6fd;
            font-weight: bold;
        }

        .option-item input[type="checkbox"] {
            margin-top: 5px;
            margin-right: 12px;
            transform: scale(1.3);
            cursor: pointer;
        }

        /* Feedback Styles */
        .option-item.correct {
            border-color: var(--success-color);
            background-color: #e8f8f0;
        }

        .option-item.wrong {
            border-color: var(--error-color);
            background-color: #fdeaea;
        }

        .option-item.missed {
            border-color: var(--warning-color);
            background-color: #fef9e7;
        }

        .feedback-badge {
            margin-left: auto;
            font-size: 0.85rem;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: bold;
        }

        .feedback-badge.correct { color: var(--success-color); border: 1px solid var(--success-color); }
        .feedback-badge.wrong { color: var(--error-color); border: 1px solid var(--error-color); }
        .feedback-badge.missed { color: var(--warning-color); border: 1px solid var(--warning-color); }

        /* Action Buttons */
        .action-area {
            margin-top: 1.5rem;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s;
        }

        .btn-primary {
            background-color: var(--accent-color);
            color: white;
        }

        .btn-primary:hover { background-color: #2980b9; }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--accent-color);
            color: var(--accent-color);
        }

        .btn-outline:hover { background-color: #f0f7fb; }

        .btn-secondary {
            background-color: #95a5a6;
            color: white;
        }

        .btn-secondary:hover { background-color: #7f8c8d; }

        .result-message {
            margin-top: 1rem;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .result-message.success { color: var(--success-color); }
        .result-message.error { color: var(--error-color); }

        /* Explanation Section */
        #explanation-area {
            display: none; /* Hidden by default */
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .exp-block {
            margin-bottom: 2rem;
            border-left: 4px solid var(--accent-color);
            padding-left: 1rem;
        }

        .exp-title {
            font-size: 1.2rem;
            color: var(--primary-color);
            margin-bottom: 0.8rem;
            font-weight: bold;
            display: flex;
            align-items: center;
        }

        .exp-title::before {
            content: '';
            display: inline-block;
            width: 8px;
            height: 8px;
            background: var(--accent-color);
            border-radius: 50%;
            margin-right: 10px;
        }

        .highlight {
            background-color: #fffacd;
            padding: 0 4px;
            border-radius: 2px;
            font-weight: bold;
        }

        .clue-box {
            background-color: #f0f4f8;
            padding: 1rem;
            border-radius: 6px;
            margin-top: 0.5rem;
            font-size: 0.95rem;
        }

        .step-list {
            margin-left: 1.5rem;
        }
        
        .step-list li {
            margin-bottom: 0.5rem;
        }

        .option-analysis {
            display: grid;
            gap: 1rem;
        }

        .analysis-card {
            background: #fff;
            border: 1px solid #eee;
            padding: 1rem;
            border-radius: 6px;
        }

        .analysis-card.correct-ans {
            border-left: 5px solid var(--error-color); /* Matches "Incorrect Statement" logic */
        }

        .analysis-card.valid-ans {
            border-left: 5px solid var(--success-color);
        }

        .tag {
            display: inline-block;
            padding: 2px 6px;
            font-size: 0.8rem;
            border-radius: 4px;
            margin-right: 5px;
            font-weight: bold;
        }
        .tag.wrong { background: #ffebeb; color: var(--error-color); }
        .tag.right { background: #e8f8f0; color: var(--success-color); }

        .concept-box {
            background: #eef2f5;
            padding: 1.2rem;
            border-radius: 6px;
        }

        .mnemonic {
            font-size: 1.1rem;
            color: var(--accent-color);
            font-weight: bold;
            text-align: center;
            padding: 1rem;
            border: 2px dashed var(--accent-color);
            border-radius: 8px;
            background: #fbfdff;
        }

        /* Responsive */
        @media (max-width: 600px) {
            header h1 { font-size: 1.4rem; }
            .action-area { flex-direction: column; }
            .btn { width: 100%; }
            .subtitle { font-size: 1rem; }
        }
    </style>
</head>
<body>

    <header>
        <div class="container">
            <h1>iPAS è³‡å®‰å¯¦å‹™é‡é»è¡åˆº</h1>
            <p class="subtitle">å»ºç«‹é¢¨éšªè™•ç†çš„æ­£ç¢ºé‚è¼¯èˆ‡æ±ºç­–è§€å¿µ</p>
            <div class="meta-info">ç¬¬33é¡Œï¼šè¤‡é¸é¡Œ | è€ƒé»ï¼šé¢¨éšªè™•ç† (Risk Treatment)</div>
        </div>
    </header>

    <div class="container">
        <!-- Stats Panel -->
        <div class="stats-panel">
            <span id="progress-text">æœ¬é¡Œå­¸ç¿’ç´€éŒ„ï¼šæœªä½œç­”</span>
            <button class="btn-text" onclick="clearProgress()" aria-label="æ¸…é™¤å­¸ç¿’é€²åº¦">æ¸…é™¤é€²åº¦</button>
        </div>

        <!-- Quiz Section -->
        <div class="card" id="quiz-card">
            <div class="question-text">
                <span class="question-type">è¤‡é¸é¡Œ</span>
                33. æœ‰é—œè³‡è¨Šå®‰å…¨ä¹‹é¢¨éšªè™•ç†ï¼Œä¸‹åˆ—ä½•é …æ•˜è¿°ã€Œæœ‰èª¤ã€ï¼Ÿ
            </div>

            <ul class="options-list" role="group" aria-label="é¸é …åˆ—è¡¨">
                <li class="option-item" onclick="toggleOption(this)">
                    <input type="checkbox" id="optA" value="A" aria-label="é¸é … A">
                    <label for="optA">
                        (A) æ‡‰ä¾æ“šé¢¨éšªè©•ä¼°æº–å‰‡èˆ‡å°è‡´è©²ç­‰é¢¨éšªä¹‹äº‹æ•…æƒ…å¢ƒä¹‹é—œä¿‚ï¼Œè¨‚å®šå„ªå…ˆåºä¹‹é¢¨éšªæ¸…å–®
                    </label>
                    <span class="feedback-badge" id="badge-A"></span>
                </li>
                <li class="option-item" onclick="toggleOption(this)">
                    <input type="checkbox" id="optB" value="B" aria-label="é¸é … B">
                    <label for="optB">
                        (B) é¢¨éšªè™•ç†æ™‚è‹¥å·²é¸æ“‡é™ä½é¢¨éšªï¼Œå‰‡ç„¡éœ€é€²è¡Œé¢¨éšªè™•ç†è¨ˆç•«
                    </label>
                    <span class="feedback-badge" id="badge-B"></span>
                </li>
                <li class="option-item" onclick="toggleOption(this)">
                    <input type="checkbox" id="optC" value="C" aria-label="é¸é … C">
                    <label for="optC">
                        (C) é¢¨éšªè™•ç†æ‡‰ç”±é«˜é¢¨éšªé …ç›®å„ªå…ˆè™•ç†
                    </label>
                    <span class="feedback-badge" id="badge-C"></span>
                </li>
                <li class="option-item" onclick="toggleOption(this)">
                    <input type="checkbox" id="optD" value="D" aria-label="é¸é … D">
                    <label for="optD">
                        (D) å°æ–¼æ‰€è­˜åˆ¥å‡ºä¹‹é¢¨éšªï¼Œåªè¦ç¶“éé¢¨éšªè™•ç†å¾Œæ‰€å‰©ä¸‹ä¾†çš„æ®˜é¤˜é¢¨éšªå³å¯
                    </label>
                    <span class="feedback-badge" id="badge-D"></span>
                </li>
            </ul>

            <div class="result-message" id="result-msg"></div>

            <div class="action-area">
                <button class="btn btn-primary" onclick="submitAnswer()">æäº¤ç­”æ¡ˆ</button>
                <button class="btn btn-outline" onclick="toggleExplanation()" id="exp-btn" style="display:none;">é¡¯ç¤ºå®Œæ•´è§£æ</button>
                <button class="btn btn-secondary" onclick="resetQuiz()" id="retry-btn" style="display:none;">é‡ä½œæœ¬é¡Œ</button>
            </div>
        </div>

        <!-- Explanation Section -->
        <div id="explanation-area">
            
            <div class="card">
                <div class="exp-block">
                    <div class="exp-title">ã€é¡Œç›®ã€‘</div>
                    <p>æœ‰é—œè³‡è¨Šå®‰å…¨ä¹‹é¢¨éšªè™•ç†ï¼Œä¸‹åˆ—ä½•é …æ•˜è¿°ã€Œæœ‰èª¤ã€ï¼Ÿ</p>
                </div>

                <div class="exp-block">
                    <div class="exp-title">ã€ç¬¬ä¸€æ­¥ï¼šæ‰¾é—œéµå­—ã€‘</div>
                    <p>è«‹æ³¨æ„é¡Œç›®ä¸­çš„ <span class="highlight">æœ‰èª¤</span>ï¼ˆé€™æ˜¯åå‘é¡Œï¼Œè¦é¸éŒ¯çš„æ•˜è¿°ï¼ï¼‰ã€‚<br>
                    æ ¸å¿ƒä¸»é¡Œæ˜¯ <span class="highlight">é¢¨éšªè™•ç† (Risk Treatment)</span>ã€‚</p>
                </div>

                <div class="exp-block">
                    <div class="exp-title">ã€ç¬¬äºŒæ­¥ï¼šç™½è©±ç¿»è­¯ã€‘</div>
                    <div class="clue-box">
                        <p><strong>é¢¨éšªè™•ç†æ˜¯ä»€éº¼ï¼Ÿ</strong><br>
                        å°±åƒä½ ç™¼ç¾æˆ¿å­æ¼æ°´ï¼ˆé¢¨éšªï¼‰ï¼Œä½ è¦æ±ºå®šæ€éº¼è¾¦ï¼šæ˜¯ä¿®å¥½å®ƒï¼ˆé™ä½ï¼‰ã€æ¬å®¶ï¼ˆé¿å…ï¼‰ã€è²·ä¿éšªï¼ˆè½‰ç§»ï¼‰ï¼Œé‚„æ˜¯æ‹¿æ°´æ¡¶æ¥æ°´å°±ç®—äº†ï¼ˆæ¥å—ï¼‰ã€‚</p>
                    </div>
                </div>

                <div class="exp-block">
                    <div class="exp-title">ã€ç¬¬ä¸‰æ­¥ï¼šè§£é¡Œæ€è·¯ã€‘</div>
                    <p><strong>é€™é¡Œåœ¨è€ƒä»€éº¼è§€å¿µï¼Ÿ</strong><br>è€ƒä½ ã€Œæ—¢ç„¶æ±ºå®šè¦è™•ç†é¢¨éšªï¼Œéœ€è¦åšå“ªäº›é…å¥—æªæ–½ã€ä»¥åŠã€Œè™•ç†ä¸å®Œçš„éƒ¨åˆ†ï¼ˆæ®˜é¤˜é¢¨éšªï¼‰è©²æ€éº¼è¾¦ã€ã€‚</p>
                    <br>
                    <strong>è§£é¡Œé‚è¼¯ï¼š</strong>
                    <ol class="step-list">
                        <li><strong>è§€å¿µ 1ï¼šè¦è™•ç†å°±è¦æœ‰è¨ˆç•«ã€‚</strong> ä½ ä¸èƒ½èªªã€Œæˆ‘è¦ä¿®æˆ¿å­ã€ç„¶å¾Œä»€éº¼è¨ˆç•«éƒ½æ²’æœ‰ï¼ˆæ²’äººä¿®ã€æ²’ææ–™ã€æ²’æœŸé™ï¼‰ã€‚</li>
                        <li><strong>è§€å¿µ 2ï¼šå‰©ä¸‹ä¾†çš„é¢¨éšªä¸èƒ½æ“ºçˆ›ã€‚</strong> è™•ç†å®Œå‰©ä¸‹çš„é¢¨éšªï¼ˆæ®˜é¤˜é¢¨éšªï¼‰ï¼Œå¿…é ˆç¢ºèªè€é—†èƒ½ä¸èƒ½æ¥å—ï¼Œä¸èƒ½åªæ˜¯ã€Œå‰©ä¸‹å°±å¥½ã€ã€‚</li>
                        <li><strong>è§€å¿µ 3ï¼šé‡è¦çš„å…ˆåšã€‚</strong> è³‡æºæœ‰é™ï¼Œç•¶ç„¶å…ˆæ•‘ç«ï¼ˆé«˜é¢¨éšªï¼‰ï¼Œå†æƒåœ°ï¼ˆä½é¢¨éšªï¼‰ã€‚</li>
                    </ol>
                </div>

                <div class="exp-block">
                    <div class="exp-title">ã€ç¬¬å››æ­¥ï¼šé¸é …åˆ†æã€‘</div>
                    <div class="option-analysis">
                        
                        <div class="analysis-card valid-ans">
                            <div><span class="tag right">æ•˜è¿°æ­£ç¢º</span> <strong>(A) è¨‚å®šå„ªå…ˆåºä¹‹é¢¨éšªæ¸…å–®</strong></div>
                            <p style="margin-top:0.5rem; color:#555;">é€™æ˜¯å°çš„ã€‚ä¾æ“šè©•ä¼°çµæœæ’éšŠï¼Œè¶Šåš´é‡çš„æ’è¶Šå‰é¢ï¼Œé€™æ˜¯æ¨™æº– SOPã€‚</p>
                        </div>

                        <div class="analysis-card correct-ans">
                            <div><span class="tag wrong">æ•˜è¿°éŒ¯èª¤</span> <strong>(B) è‹¥é¸æ“‡é™ä½é¢¨éšªï¼Œå‰‡ç„¡éœ€é€²è¡Œé¢¨éšªè™•ç†è¨ˆç•«</strong></div>
                            <p style="margin-top:0.5rem; color:#c0392b;"><strong>éŒ¯åœ¨é€™è£¡ï¼</strong></p>
                            <p>ã€Œé™ä½é¢¨éšªã€é€šå¸¸æ¶‰åŠå°å…¥æ§åˆ¶æªæ–½ï¼ˆä¾‹å¦‚è£é˜²ç«ç‰†ã€ä¿®è£œæ¼æ´ï¼‰ã€‚é€™å°±åƒã€Œä¿®æ¼æ°´å·¥ç¨‹ã€ï¼Œä¸€å®šè¦æœ‰æ–½å·¥å–®ï¼ˆ<strong>é¢¨éšªè™•ç†è¨ˆç•«</strong>ï¼‰ï¼Œè¼‰æ˜è¦åšä»€éº¼ã€èª°è² è²¬ã€é ç®—å¤šå°‘ã€ä½•æ™‚å®Œå·¥ã€‚</p>
                        </div>

                        <div class="analysis-card valid-ans">
                            <div><span class="tag right">æ•˜è¿°æ­£ç¢º</span> <strong>(C) æ‡‰ç”±é«˜é¢¨éšªé …ç›®å„ªå…ˆè™•ç†</strong></div>
                            <p style="margin-top:0.5rem; color:#555;">é€™æ˜¯å°çš„ã€‚é¢¨éšªç®¡ç†çš„æ ¸å¿ƒå°±æ˜¯ã€Œè³‡æºé…ç½®ã€ï¼Œç•¶ç„¶æ˜¯é«˜é¢¨éšªï¼ˆHigh Riskï¼‰å„ªå…ˆã€‚</p>
                        </div>

                        <div class="analysis-card correct-ans">
                            <div><span class="tag wrong">æ•˜è¿°éŒ¯èª¤</span> <strong>(D) åªè¦ç¶“éé¢¨éšªè™•ç†å¾Œæ‰€å‰©ä¸‹ä¾†çš„æ®˜é¤˜é¢¨éšªå³å¯</strong></div>
                            <p style="margin-top:0.5rem; color:#c0392b;"><strong>éŒ¯åœ¨é€™è£¡ï¼</strong></p>
                            <p>é€™å¥è©±èªæ„ä¸æ˜ä¸”é‚è¼¯éŒ¯èª¤ã€‚<strong>æ®˜é¤˜é¢¨éšª (Residual Risk)</strong> æ˜¯æŒ‡ã€Œæ¡å–å°ç­–å¾Œä»å­˜åœ¨çš„é¢¨éšªã€ã€‚é—œéµä¸åœ¨æ–¼ã€Œåªè¦å‰©ä¸‹ä¾†å°±å¥½ã€ï¼Œè€Œåœ¨æ–¼<strong>ã€Œå‰©ä¸‹çš„é¢¨éšªæ˜¯å¦åœ¨å¯æ¥å—æ°´æº– (Acceptable Level) å…§ã€</strong>ã€‚å¦‚æœå‰©ä¸‹çš„é¢¨éšªé‚„æ˜¯å¤ªé«˜ï¼Œå°±ä¸èƒ½çµæ¡ˆï¼Œå¿…é ˆç¹¼çºŒè™•ç†æˆ–å°‹æ±‚é«˜å±¤ç°½æ ¸åŒæ„ã€‚</p>
                        </div>

                    </div>
                </div>

                <div class="exp-block">
                    <div class="exp-title">ã€è§€å¿µè£œå……èˆ‡å»¶ä¼¸ã€‘</div>
                    <div class="concept-box">
                        <p><strong>iPAS è€ƒé»å®šä½ï¼š</strong> <span style="color:var(--error-color); font-weight:bold;">â˜…â˜…â˜…â˜…â˜… å¿…è€ƒ</span></p>
                        <hr style="margin:10px 0; border:0; border-top:1px solid #ccc;">
                        <p><strong>ISO 27005 é¢¨éšªç®¡ç†ç²¾ç¥ï¼š</strong></p>
                        <ul>
                            <li><strong>é¢¨éšªè™•ç†é¸é … (4T)ï¼š</strong>
                                <ul>
                                    <li><strong>Treat / Modify (é™ä½/ä¿®æ”¹)ï¼š</strong> åŠ è£é˜²è­·æªæ–½ï¼ˆæœ€å¸¸è¦‹ï¼‰ã€‚</li>
                                    <li><strong>Terminate / Avoid (é¿å…)ï¼š</strong> å¤ªå±éšªäº†ï¼Œä¹¾è„†ä¸è¦åšé€™é …æ¥­å‹™ã€‚</li>
                                    <li><strong>Transfer / Share (ç§»è½‰/åˆ†æ“”)ï¼š</strong> è²·ä¿éšªæˆ–å¤–åŒ…çµ¦å» å•†ã€‚</li>
                                    <li><strong>Tolerate / Retain (æ¥å—/ä¿ç•™)ï¼š</strong> é¢¨éšªå¾ˆå°ï¼Œæˆæœ¬æ¯”æå¤±é‚„é«˜ï¼Œç›´æ¥æ¥å—ã€‚</li>
                                </ul>
                            </li>
                            <br>
                            <li><strong>æ®˜é¤˜é¢¨éšªé‡é»ï¼š</strong> å¿…é ˆç¶“éç®¡ç†éšå±¤æ­£å¼æ‰¹å‡†ï¼ˆSign-offï¼‰ã€‚</li>
                        </ul>
                    </div>
                </div>

                <div class="exp-block">
                    <div class="exp-title">ã€è¨˜æ†¶å£è¨£ã€‘</div>
                    <div class="mnemonic">
                        è™•ç†è¦æœ‰è¨ˆç•«å–®ï¼Œæ®˜é¤˜é¢¨éšªè¦æ ¸å‡†ï¼
                    </div>
                </div>

                <div class="exp-block">
                    <div class="exp-title">ã€å¸¸è¦‹é™·é˜±ã€‘</div>
                    <p>è€ƒç”Ÿå¸¸èª¤ä»¥ç‚ºã€Œæ¥å—é¢¨éšªã€å°±æ˜¯ä»€éº¼éƒ½ä¸åšã€‚å…¶å¯¦ã€Œæ¥å—ã€æ˜¯ä¸€å€‹<strong>ä¸»å‹•çš„æ±ºç­– (Decision)</strong>ï¼Œéœ€è¦è©•ä¼°å¾Œæ­£å¼è¨˜éŒ„ã€Œæˆ‘å€‘æ±ºå®šä¸è™•ç†å®ƒã€ï¼Œè€Œä¸æ˜¯å–®ç´”çš„å¿½ç•¥ã€‚</p>
                </div>

                <div class="exp-block">
                    <div class="exp-title">ã€æ­£ç¢ºç­”æ¡ˆã€‘</div>
                    <p style="font-size:1.2rem; font-weight:bold; color:var(--error-color);">ç­”æ¡ˆï¼š(B)ã€(D)</p>
                    <p>ç†ç”±ï¼š(B)ç¼ºè¨ˆç•«ã€(D)ç¼ºè©•ä¼°å¯æ¥å—æ€§ã€‚</p>
                </div>

                <div class="exp-block">
                    <div class="exp-title">ã€è‡ªæˆ‘æª¢æ¸¬ã€‘</div>
                    <div style="background:#f9f9f9; padding:1rem; border-radius:6px;">
                        <p><strong>Q1. è²·ä¿éšªå±¬æ–¼å“ªä¸€ç¨®é¢¨éšªè™•ç†ç­–ç•¥ï¼Ÿ</strong></p>
                        <p style="color:#666; font-size:0.9rem; margin-bottom:1rem;">(é»æ“Šçœ‹ç­”æ¡ˆï¼š<span onclick="this.innerText='ç§»è½‰ (Transfer)'" style="cursor:pointer; text-decoration:underline;">é¡¯ç¤ºç­”æ¡ˆ</span>)</p>
                        
                        <p><strong>Q2. æ±ºå®šã€Œé—œé–‰æŸå€‹æœ‰æ¼æ´ä¸”ä¸å¸¸ç”¨çš„èˆŠä¼ºæœå™¨ã€ï¼Œå±¬æ–¼å“ªç¨®ç­–ç•¥ï¼Ÿ</strong></p>
                        <p style="color:#666; font-size:0.9rem;">(é»æ“Šçœ‹ç­”æ¡ˆï¼š<span onclick="this.innerText='é¿å… (Avoid)'" style="cursor:pointer; text-decoration:underline;">é¡¯ç¤ºç­”æ¡ˆ</span>)</p>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        // Data & State
        const CORRECT_ANSWERS = ['B', 'D']; // The question asks for "Incorrect statements", options B and D are factually incorrect statements.
        const STORAGE_KEY = 'ipas_q33_stats';
        
        let userStats = {
            attempts: 0,
            correctCount: 0
        };

        // DOM Elements
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        const optionItems = document.querySelectorAll('.option-item');
        const resultMsg = document.getElementById('result-msg');
        const expBtn = document.getElementById('exp-btn');
        const retryBtn = document.getElementById('retry-btn');
        const explanationArea = document.getElementById('explanation-area');
        const progressText = document.getElementById('progress-text');

        // Init
        window.onload = function() {
            loadStats();
            updateStatsUI();
        };

        // Functions
        function toggleOption(li) {
            // Prevent toggling if disabled (already submitted)
            const checkbox = li.querySelector('input');
            if (checkbox.disabled) return;

            // Toggle checkbox if clicked on LI (but not if clicked directly on checkbox to avoid double toggle)
            if (event.target !== checkbox) {
                checkbox.checked = !checkbox.checked;
            }
            
            // Visual feedback for selection
            if (checkbox.checked) {
                li.classList.add('selected');
            } else {
                li.classList.remove('selected');
            }
        }

        function submitAnswer() {
            // Disable inputs
            let selectedValues = [];
            checkboxes.forEach(cb => {
                if (cb.checked) selectedValues.push(cb.value);
                cb.disabled = true;
                cb.parentElement.onclick = null; // Remove click handler
                cb.parentElement.style.cursor = 'default';
            });

            if (selectedValues.length === 0) {
                alert("è«‹è‡³å°‘é¸æ“‡ä¸€å€‹é¸é …ï¼");
                // Re-enable to let user correct
                checkboxes.forEach(cb => {
                    cb.disabled = false;
                    cb.parentElement.setAttribute('onclick', 'toggleOption(this)');
                    cb.parentElement.style.cursor = 'pointer';
                });
                return;
            }

            // Check Logic
            // The user must select EXACTLY B and D to get it fully right? 
            // Or do we mark individual choices? 
            // Let's grade based on strict set equality for the stats, but give visual feedback for each.
            
            let isPerfect = false;
            // Sort arrays to compare
            const sortedSelected = selectedValues.sort().toString();
            const sortedCorrect = CORRECT_ANSWERS.sort().toString();
            
            if (sortedSelected === sortedCorrect) {
                isPerfect = true;
                resultMsg.innerHTML = "ğŸ‰ ç­”å°äº†ï¼è§€å¿µéå¸¸æ­£ç¢ºï¼";
                resultMsg.className = "result-message success";
                userStats.correctCount++;
            } else {
                resultMsg.innerHTML = "âš ï¸ ç­”æ¡ˆä¸å®Œå…¨æ­£ç¢ºï¼Œè«‹çœ‹ä¸‹æ–¹æ¨™è¨˜ã€‚";
                resultMsg.className = "result-message error";
            }

            // Update Stats
            userStats.attempts++;
            saveStats();
            updateStatsUI();

            // Visual Feedback Logic
            optionItems.forEach(li => {
                const cb = li.querySelector('input');
                const val = cb.value;
                const badge = li.querySelector('.feedback-badge');
                
                li.classList.remove('selected'); // Remove selection style to show result style clearly

                // Logic:
                // 1. Should be selected (B, D) AND was selected -> CORRECT (Green)
                // 2. Should be selected (B, D) but NOT selected -> MISSED (Orange)
                // 3. Should NOT be selected (A, C) but WAS selected -> WRONG (Red)
                // 4. Should NOT be selected and NOT selected -> Neutral (Correctly ignored)

                const isCorrectOption = CORRECT_ANSWERS.includes(val);
                const isSelected = cb.checked;

                if (isCorrectOption && isSelected) {
                    li.classList.add('correct');
                    badge.textContent = "âœ” é¸å°äº†";
                    badge.className = "feedback-badge correct";
                } else if (isCorrectOption && !isSelected) {
                    li.classList.add('missed');
                    badge.textContent = "â­• æ¼é¸äº†";
                    badge.className = "feedback-badge missed";
                } else if (!isCorrectOption && isSelected) {
                    li.classList.add('wrong');
                    badge.textContent = "âŒ é¸éŒ¯äº†";
                    badge.className = "feedback-badge wrong";
                } else {
                    // Correctly ignored
                    // badge.textContent = "æ­£ç¢ºæœªé¸"; // Optional: usually keep clean
                }
            });

            // Show Buttons
            document.querySelector('.btn-primary').style.display = 'none'; // Hide submit
            expBtn.style.display = 'inline-block';
            retryBtn.style.display = 'inline-block';
            
            // Auto open explanation if wrong
            if (!isPerfect) {
                // Optional: Auto open? Let's keep it manual to not overwhelm, 
                // but emphasize the button.
                expBtn.classList.add('btn-primary');
                expBtn.classList.remove('btn-outline');
                expBtn.textContent = "æŸ¥çœ‹è§£æ (æ¨è–¦)";
            }
        }

        function toggleExplanation() {
            if (explanationArea.style.display === 'block') {
                explanationArea.style.display = 'none';
                expBtn.textContent = "é¡¯ç¤ºå®Œæ•´è§£æ";
            } else {
                explanationArea.style.display = 'block';
                expBtn.textContent = "æ”¶åˆè§£æ";
                // Scroll to explanation
                explanationArea.scrollIntoView({ behavior: 'smooth' });
            }
        }

        function resetQuiz() {
            // Reset UI
            checkboxes.forEach(cb => {
                cb.checked = false;
                cb.disabled = false;
            });
            
            optionItems.forEach(li => {
                li.className = 'option-item';
                li.setAttribute('onclick', 'toggleOption(this)');
                li.style.cursor = 'pointer';
                li.querySelector('.feedback-badge').textContent = "";
                li.querySelector('.feedback-badge').className = "feedback-badge";
            });

            resultMsg.textContent = "";
            resultMsg.className = "result-message";
            
            document.querySelector('.btn-primary').style.display = 'inline-block';
            expBtn.style.display = 'none';
            retryBtn.style.display = 'none';
            explanationArea.style.display = 'none';
            
            // Reset button style
            expBtn.className = 'btn btn-outline';
            
            // Scroll top
            document.getElementById('quiz-card').scrollIntoView({ behavior: 'smooth' });
        }

        // Local Storage Functions
        function loadStats() {
            const stored = localStorage.getItem(STORAGE_KEY);
            if (stored) {
                userStats = JSON.parse(stored);
            }
        }

        function saveStats() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(userStats));
        }

        function updateStatsUI() {
            if (userStats.attempts === 0) {
                progressText.textContent = "æœ¬é¡Œå­¸ç¿’é€²åº¦ï¼šå°šæœªé–‹å§‹";
            } else {
                const rate = Math.round((userStats.correctCount / userStats.attempts) * 100);
                progressText.textContent = `æœ¬é¡Œå­¸ç¿’é€²åº¦ï¼šå·²ç·´ç¿’ ${userStats.attempts} æ¬¡ï¼Œç­”å° ${userStats.correctCount} æ¬¡ (æ­£ç¢ºç‡ ${rate}%)`;
            }
        }

        function clearProgress() {
            if(confirm('ç¢ºå®šè¦æ¸…é™¤æœ¬é¡Œçš„å­¸ç¿’ç´€éŒ„å—ï¼Ÿ')) {
                userStats = { attempts: 0, correctCount: 0 };
                saveStats();
                updateStatsUI();
                resetQuiz();
            }
        }
    </script>
</body>
</html>