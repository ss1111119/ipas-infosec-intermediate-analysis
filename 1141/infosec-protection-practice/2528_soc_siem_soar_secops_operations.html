<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¡Œçµ„ 3ï½œå®Œæ•´æ•™å­¸æ¨¡æ¿ - è³‡å®‰ç›£æ§ç¶­é‹ä¸­å¿ƒ</title>
    <style>
        /* --- 1. åŸºç¤è¨­å®šèˆ‡è®Šæ•¸ --- */
        :root {
            --body-bg: #f4f7f6;
            --card-bg: #ffffff;
            --text-primary: #2c3e50;
            --text-secondary: #546e7a;
            --primary: #2980b9;
            --primary-light: #e3f2fd;
            --primary-hover: #3498db;
            --highlight: #f1c40f;
            --success-bg: #e8f5e9;
            --success-text: #2e7d32;
            --error-bg: #fce4ec;
            --error-text: #c62828;
            --border-color: #e0e0e0;
            --radius-lg: 16px;
            --radius-md: 12px;
            --radius-sm: 8px;
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: system-ui, "Noto Sans TC", sans-serif;
            background-color: var(--body-bg);
            color: var(--text-primary);
            margin: 0;
            line-height: 1.6;
        }

        /* --- 2. ä½ˆå±€å®¹å™¨ (éŸ¿æ‡‰å¼) --- */
        .page-container {
            max-width: 960px;
            width: 100%;
            margin: 40px auto;
            padding: 40px;
            background-color: var(--card-bg);
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border-radius: var(--radius-lg);
        }

        @media (max-width: 768px) {
            .page-container {
                max-width: 100%;
                margin: 16px;
                padding: 20px;
                border-radius: var(--radius-md);
            }
            body { font-size: 14px; }
            h2 { font-size: 20px; }
            h3 { font-size: 16px; }
        }

        /* --- 3. é¡Œçµ„ Header --- */
        .group-header {
            margin-bottom: 30px;
            border-bottom: 2px solid var(--body-bg);
            padding-bottom: 20px;
        }

        .group-header h1 {
            color: var(--primary);
            margin: 0 0 15px 0;
            font-size: 1.5rem;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background-color: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--primary-hover));
            width: 0%;
            transition: width 400ms ease;
        }

        .completion-status {
            font-size: 0.9rem;
        }

        .status-pending { color: var(--text-secondary); }
        .status-done { color: var(--success-text); font-weight: bold; }

        /* --- 4. Context å€åŸŸ --- */
        .group-context {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: var(--radius-md);
            border-left: 5px solid var(--primary);
            margin-bottom: 30px;
        }
        .group-context h3 { margin-top: 0; color: var(--text-secondary); }

        /* --- 5. Tabs å°èˆª --- */
        .tabs-container {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 10px;
            margin-bottom: 20px;
            scrollbar-width: none; /* Firefox */
        }
        .tabs-container::-webkit-scrollbar { display: none; }

        .tab-btn {
            background: #f1f1f1;
            border: none;
            padding: 10px 20px;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-weight: 500;
            color: var(--text-secondary);
            white-space: nowrap;
            transition: all 200ms ease;
            min-height: 48px; /* è§¸æ§å‹å–„ */
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .tab-btn:hover {
            background-color: var(--primary-light);
            transform: translateY(-2px);
        }

        .tab-btn.active {
            background-color: var(--primary);
            color: white;
            box-shadow: 0 4px 8px rgba(41,128,185,0.3);
        }

        .tab-status {
            font-size: 0.8em;
            font-weight: bold;
        }

        /* --- 6. é¡Œç›®å…§å®¹å€ --- */
        .tab-content {
            display: none;
            animation: fadeIn 300ms ease;
        }
        .tab-content.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .question-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .q-badge {
            background: var(--text-primary);
            color: white;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: bold;
        }
        .q-badge.status-correct { background: var(--success-text); }
        .q-badge.status-wrong { background: var(--error-text); }

        .question-text {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 20px;
        }

        /* --- 7. é¸é …æ¨£å¼ --- */
        .options-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 25px;
        }

        .option {
            display: flex;
            align-items: flex-start;
            padding: 16px;
            border: 2px solid #eee;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 150ms ease;
            position: relative;
        }

        .option:hover:not(.disabled) {
            background-color: var(--primary-light);
            border-color: var(--primary-light);
        }

        .option.selected {
            background-color: var(--primary-light);
            border-color: var(--primary);
        }

        .option input {
            margin-top: 5px;
            margin-right: 12px;
            accent-color: var(--primary);
            transform: scale(1.2);
        }

        .option.disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        /* --- 8. æŒ‰éˆ•å€åŸŸ --- */
        .action-area {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 200ms ease;
            min-height: 44px;
            width: 100%;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(41,128,185,0.3);
            background-color: var(--primary-hover);
        }

        .btn-reset {
            background-color: var(--text-secondary);
            color: white;
        }
        .btn-reset:hover {
            background-color: #34495e;
        }

        /* --- 9. å›é¥‹èˆ‡è§£æ --- */
        .feedback {
            margin-top: 20px;
            padding: 15px 20px;
            border-radius: var(--radius-sm);
            display: none; /* JS åˆ‡æ› */
            animation: fadeInUp 300ms ease;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(10px); }
            to   { opacity: 1; transform: translateY(0); }
        }

        .feedback.success { background-color: var(--success-bg); color: var(--success-text); border: 1px solid #c8e6c9; }
        .feedback.error { background-color: var(--error-bg); color: var(--error-text); border: 1px solid #ffcdd2; }

        details {
            margin-top: 15px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            overflow: hidden;
            background: white;
        }

        summary {
            padding: 15px;
            cursor: pointer;
            font-weight: 600;
            background-color: #fafafa;
            list-style: none; /* éš±è—é è¨­ç®­é ­ */
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        summary::after {
            content: '+';
            font-size: 1.2em;
            font-weight: bold;
        }
        
        details[open] summary::after {
            content: '-';
        }

        .details-content {
            padding: 20px;
            border-top: 1px solid var(--border-color);
        }

        /* è§£æåˆ†æ®µå¡ */
        .explain-section {
            background-color: #f8f9fa;
            border-left: 4px solid var(--primary);
            padding: 15px 20px;
            margin-bottom: 15px;
            border-radius: 0 8px 8px 0;
        }
        .explain-section h4 {
            margin-top: 0;
            color: var(--primary);
            font-size: 1.05rem;
            margin-bottom: 10px;
        }
        
        /* è§£æå…§å®¹çš„å°æ¨™é¡Œ (ä¾‹å¦‚ï¼šåŸç†èˆ‡è¦å‰‡ã€ç”Ÿæ´»ä¾‹å­) */
        .sub-header {
            font-weight: bold;
            color: var(--text-secondary);
            margin-top: 10px;
            display: block;
        }

        .explain-section p { margin-bottom: 8px; }
        .explain-section ul { margin: 8px 0 8px 20px; padding: 0; }

        /* è‡ªæˆ‘æª¢æ¸¬å€å¡Š */
        .self-check-container {
            margin-top: 20px;
            border: 2px dashed var(--primary);
            border-radius: var(--radius-sm);
            padding: 15px;
            background-color: var(--primary-light);
            display: none; /* é è¨­éš±è—ï¼Œé€å‡ºå¾Œé¡¯ç¤º */
        }
        .self-check-q {
            font-weight: bold;
            color: var(--text-primary);
            margin: 0 0 10px 0;
        }
        .self-check-details {
            margin-top: 0;
            border: none;
            background: rgba(255,255,255,0.5);
        }
        .self-check-details summary {
            background: transparent;
            padding: 5px 10px;
            font-size: 0.9rem;
            color: var(--primary);
        }
        .self-check-details .details-content {
            padding: 10px;
            border-top: 1px dashed var(--primary);
            color: var(--success-text);
            font-weight: bold;
        }

        /* --- 10. æ¨™ç±¤é¡è‰²ç³»çµ± --- */
        .tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            margin-right: 5px;
            font-weight: normal;
        }
        .tag-law { background-color: #607d8b; color: white; }
        .tag-iso { background-color: #27ae60; color: white; }
        .tag-zt  { background-color: #8e44ad; color: white; }
        .tag-net { background-color: #2980b9; color: white; }
        .tag-sec { background-color: #c0392b; color: white; } /* æŠ€è¡“ */
        .tag-mgm { background-color: #d35400; color: white; } /* é¢¨éšª/ç®¡ç† */

        mark {
            background-color: var(--highlight);
            color: var(--text-primary);
            padding: 0 4px;
            border-radius: 2px;
        }

    </style>
</head>
<body>

<div class="page-container">
    <!-- 1. Header -->
    <header class="group-header">
        <h1>é¡Œçµ„ 3ï½œå®Œæ•´æ•™å­¸æ¨¡æ¿</h1>
        <div class="progress-info">
            <span id="progress-text">å·²å®Œæˆï¼š<strong>0</strong> / 4</span>
        </div>
        <div class="progress-bar">
            <div id="progress-fill" class="progress-fill"></div>
        </div>
        <div class="completion-status">
            <span id="status-text" class="status-pending">ğŸ“ å°šæœªå®Œæˆ</span>
        </div>
    </header>

    <!-- 2. Context -->
    <div class="group-context">
        <h3>ğŸ“– é¡Œçµ„èƒŒæ™¯</h3>
        <p>æŸå…¬å¸ç‚ºå› æ‡‰æ½›åœ¨çš„è³‡å®‰å¨è„…ï¼Œè€Œè¨­ç«‹<mark>è³‡å®‰ç›£æ§ç¶­é‹ä¸­å¿ƒï¼ˆSOCï¼‰</mark>ï¼Œä¸¦æ“¬æ¡è³¼ç›¸é—œè»Ÿç¡¬é«”åŠè³‡å®‰è§£æ±ºæ–¹æ¡ˆï¼Œä»¥æå‡æ•´é«”è³‡å®‰é˜²è­·èˆ‡æ‡‰è®Šèƒ½åŠ›ã€‚</p>
    </div>

    <!-- 3. Tabs -->
    <div class="tabs-container" id="tabs-container">
        <!-- JS ç”Ÿæˆ Tabs -->
    </div>

    <!-- 4. Tab Contents -->
    <div id="questions-container">
        <!-- JS ç”Ÿæˆé¡Œç›®å…§å®¹ -->
    </div>
</div>

<script>
    // --- è³‡æ–™çµæ§‹ ---
    const quizData = {
        groupName: "é¡Œçµ„ 3ï½œå®Œæ•´æ•™å­¸æ¨¡æ¿",
        questions: [
            {
                id: 1,
                originalNum: 25,
                type: "single",
                tags: ["tag-mgm"],
                question: "è©²å…¬å¸è©•ä¼°åœ˜éšŠé‡å°è³‡å®‰ç›£æ§ç¶­é‹ä¸­å¿ƒï¼ˆSOCï¼‰å…ˆé€²è¡Œåˆæ­¥çš„ä»»å‹™ç•Œå®šï¼Œè©¦å•ä¸‹åˆ—é—œæ–¼è³‡å®‰ç›£æ§ç¶­é‹ä¸­å¿ƒçš„æ•˜è¿°ä½•è€…æœ€ã€Œä¸ã€é©åˆ‡ï¼Ÿ",
                options: [
                    { id: "A", text: "æŒçºŒç›£æ§ä¼æ¥­çš„è³‡è¨Šç³»çµ±ã€ç¶²è·¯å’Œæ‡‰ç”¨" },
                    { id: "B", text: "è² è²¬å°è­˜åˆ¥åˆ°çš„å®‰å…¨äº‹ä»¶é€²è¡ŒåŠæ™‚å›æ‡‰å’Œç®¡ç†" },
                    { id: "C", text: "æä¾›æœ‰é—œè³‡è¨Šå®‰å…¨äº‹ä»¶çš„å ±å‘Šã€ç´€éŒ„ã€è¿½è¹¤ã€åˆ†æå’Œçµ±è¨ˆ" },
                    { id: "D", text: "å¯ä»¥é€éå°å…¥å–®ä¸€ç”¢å“çš„æ–¹å¼ä¾†é”æˆæ‰€è¨­å®šçš„ç›®æ¨™" }
                ],
                correctAnswer: ["D"],
                reason: "SOC æ˜¯ä¸€å€‹ã€Œäººï¼‹æµç¨‹ï¼‹æŠ€è¡“ã€çš„ç‡Ÿé‹ä¸­å¿ƒï¼Œçµ•éå–®ä¸€ç”¢å“å¯å–ä»£ã€‚",
                explanation: `
                    <!-- 1. æ‰¾é—œéµå­— -->
                    <div class="explain-section">
                        <h4>ğŸ” ç¬¬ä¸€æ­¥ï¼šæ‰¾é—œéµå­—</h4>
                        <p>è³‡å®‰ç›£æ§ç¶­é‹ä¸­å¿ƒï¼ˆSOCï¼‰ã€åˆæ­¥ä»»å‹™ç•Œå®šã€æœ€ã€Œä¸ã€é©åˆ‡ã€å–®ä¸€ç”¢å“ã€‚</p>
                        <p>â†’ é—œéµåœ¨<strong>ã€ŒSOC çš„è§’è‰²å®šä½ã€</strong>èˆ‡<strong>ã€Œæ˜¯ä¸æ˜¯èƒ½é ä¸€å€‹ç”¢å“å®Œæˆã€</strong>ã€‚</p>
                    </div>

                    <!-- 2. ç™½è©±ç¿»è­¯ -->
                    <div class="explain-section">
                        <h4>ğŸ’¡ ç¬¬äºŒæ­¥ï¼šç™½è©±ç¿»è­¯</h4>
                        <p>å…¬å¸è¦æˆç«‹ SOCï¼Œè«‹å•ä¸‹é¢å“ªä¸€å€‹èªªæ³•<strong>ã€Œæœ€ä¸åƒçœŸæ­£çš„ SOC æœƒåšçš„äº‹ã€</strong>ï¼Ÿ</p>
                    </div>

                    <!-- 3. è§£é¡Œæ€è·¯ (åŒ…å«æ­¥é©Ÿã€åŸç†ã€ç”Ÿæ´»ä¾‹å­) -->
                    <div class="explain-section">
                        <h4>ğŸ§  ç¬¬ä¸‰æ­¥ï¼šè§£é¡Œæ€è·¯</h4>
                        <span class="sub-header">ã€è§£é¡Œæ­¥é©Ÿã€‘</span>
                        <p>1. å…ˆæƒ³ SOC å¹³å¸¸åœ¨å¹¹å˜›ï¼ˆçœ‹ã€åˆ†æã€è™•ç†è³‡å®‰äº‹ä»¶ï¼‰ã€‚</p>
                        <p>2. å†çœ‹å“ªå€‹é¸é …æŠŠ SOC èªªå¾—ã€Œå¤ªç°¡å–®ã€å¤ªå·¥å…·åŒ–ã€ã€‚</p>
                        
                        <span class="sub-header">ã€åŸç†èˆ‡è¦å‰‡ã€‘</span>
                        <p>SOC (Security Operations Center) æ˜¯ä¸€å€‹è² è²¬æŒçºŒç›£æ§ã€åˆ†æèˆ‡å›æ‡‰è³‡å®‰äº‹ä»¶çš„<strong>çµ„ç¹”èˆ‡æµç¨‹</strong>ï¼Œä¸æ˜¯å–®ä¸€è»Ÿé«”ã€‚</p>
                        
                        <span class="sub-header">ã€ç”Ÿæ´»ä¾‹å­ã€‘</span>
                        <p>SOC å°±åƒ<strong>é†«é™¢æ€¥è¨ºå®¤</strong>ã€‚é†«é™¢ä¸å¯èƒ½åªè²·ä¸€å°ã€Œè¶…ç´šæª¢æŸ¥æ©Ÿã€å°±ç•¶ä½œæ€¥è¨ºå®¤é‹ä½œï¼Œé‚„éœ€è¦é†«ç”Ÿï¼ˆäººï¼‰ã€æª¢å‚·åˆ†é¡SOPï¼ˆæµç¨‹ï¼‰æ‰èƒ½æ•‘äººã€‚</p>
                    </div>

                    <!-- 4. é¸é …åˆ†æ -->
                    <div class="explain-section">
                        <h4>âš–ï¸ ç¬¬å››æ­¥ï¼šé¸é …åˆ†æ</h4>
                        <ul>
                            <li><strong>(A) æ­£ç¢ºï¼š</strong>æŒçºŒç›£æ§æ˜¯ SOC çš„æ ¸å¿ƒå·¥ä½œã€‚</li>
                            <li><strong>(B) æ­£ç¢ºï¼š</strong>å›æ‡‰èˆ‡ç®¡ç†äº‹ä»¶æ˜¯ SOC çš„å­˜åœ¨åƒ¹å€¼ã€‚</li>
                            <li><strong>(C) æ­£ç¢ºï¼š</strong>SOC ä¹Ÿè² è²¬ç®¡ç†ç´€éŒ„èˆ‡å›æº¯å ±å‘Šã€‚</li>
                            <li><strong>(D) éŒ¯èª¤ï¼š</strong>SOC éœ€è¦ã€Œäººï¼‹æµç¨‹ï¼‹æŠ€è¡“ã€æ•´åˆï¼Œä¸å¯èƒ½åªé å°å…¥å–®ä¸€ç”¢å“å°±é”æˆã€‚</li>
                        </ul>
                    </div>

                    <!-- 5. è§€å¿µè£œå……èˆ‡å»¶ä¼¸ (å…¨é¤) -->
                    <div class="explain-section">
                        <h4>ğŸ›¡ï¸ è§€å¿µè£œå……èˆ‡å»¶ä¼¸</h4>
                        
                        <span class="sub-header">ã€è§¸é¡æ—é€šï¼ˆèˆ‰ä¸€åä¸‰ï¼‰ã€‘</span>
                        <p>SOC â‰  SIEMã€‚SIEM æ˜¯å·¥å…·ï¼ŒSOC æ˜¯ä½¿ç”¨å·¥å…·çš„åœ˜éšŠã€‚</p>

                        <span class="sub-header">ã€è¨˜æ†¶å£è¨£ã€‘</span>
                        <p>ã€ŒSOC ä¸æ˜¯ä¸€å¥—è»Ÿé«”ï¼Œæ˜¯ä¸€å€‹åœ˜éšŠã€‚ã€</p>

                        <span class="sub-header">ã€å¸¸è¦‹é™·é˜±ã€‘</span>
                        <p>æŠŠ SOC ç•¶æˆæŸä¸€å¥—è³‡å®‰ç”¢å“ï¼ˆå¦‚é˜²æ¯’è»Ÿé«”æˆ–é˜²ç«ç‰†ï¼‰ã€‚</p>

                        <span class="sub-header">ã€å¿ƒç†ç›²é»ã€‘</span>
                        <p>çœ‹åˆ°é«˜åƒ¹å·¥å…·å°±ä»¥ç‚ºå•é¡Œè§£æ±ºäº†ï¼Œå¿½ç•¥äº†ã€Œäººã€çš„é‡è¦æ€§ã€‚</p>

                        <span class="sub-header">ã€é¿å‘æŒ‡å—ã€‘</span>
                        <p>é¡Œç›®çœ‹åˆ°<strong>ã€Œå–®ä¸€ç”¢å“å®Œæˆå…¨éƒ¨ã€</strong>ï¼Œè«‹é«˜åº¦è­¦è¦ºï¼Œé€šå¸¸æ˜¯éŒ¯çš„ã€‚</p>
                    </div>
                `,
                selfCheck: {
                    q: "SOC èƒ½ä¸èƒ½å¤–åŒ…ï¼Ÿ",
                    a: "å¯ä»¥ï¼ˆMSSPï¼‰ï¼Œä½†æµç¨‹èˆ‡ç›£æ§çš„æœ€çµ‚è²¬ä»»ä»åœ¨çµ„ç¹”æœ¬èº«ã€‚"
                }
            },
            {
                id: 2,
                originalNum: 26,
                type: "single",
                tags: ["tag-sec"],
                question: "é—œæ–¼å®‰å…¨è³‡è¨Šèˆ‡äº‹ä»¶ç®¡ç†ï¼ˆSIEMï¼‰çš„åŠŸèƒ½æ•˜è¿°ï¼Œä½•é …æœ€ã€Œä¸ã€é©åˆ‡ï¼Ÿ",
                options: [
                    { id: "A", text: "ç›£æ§ä¼æ¥­å…§å¤–çš„è³‡å®‰äº‹ä»¶ï¼Œå¦‚ logsã€alertsã€events" },
                    { id: "B", text: "åŒ¯èšå¤šä¾†æºè³‡æ–™ä¸¦ä¾è¦å‰‡é€²è¡Œåˆ†æèˆ‡å‘Šè­¦" },
                    { id: "C", text: "ç¼ºä¹é—œè¯åˆ†æã€è¡Œç‚ºåˆ†æèˆ‡ç•°å¸¸åµæ¸¬æŠ€è¡“" },
                    { id: "D", text: "æä¾›äº‹ä»¶æŸ¥è©¢ã€å ±è¡¨ã€èª¿æŸ¥èˆ‡å–è­‰åŠŸèƒ½" }
                ],
                correctAnswer: ["C"],
                reason: "SIEM çš„æ ¸å¿ƒå¼·é …æ­£æ˜¯ã€Œé—œè¯åˆ†æï¼ˆCorrelationï¼‰ã€èˆ‡ç•°å¸¸åµæ¸¬ï¼Œé¸é … C èªªç¼ºä¹èˆ‡äº‹å¯¦ç›¸åã€‚",
                explanation: `
                    <!-- 1. æ‰¾é—œéµå­— -->
                    <div class="explain-section">
                        <h4>ğŸ” ç¬¬ä¸€æ­¥ï¼šæ‰¾é—œéµå­—</h4>
                        <p>SIEMã€åŠŸèƒ½æ•˜è¿°ã€æœ€ã€Œä¸ã€é©åˆ‡ã€ç¼ºä¹é—œè¯åˆ†æã€‚</p>
                        <p>â†’ é—œéµåœ¨<strong>ã€ŒSIEM çš„æ ¸å¿ƒèƒ½åŠ›ã€</strong>ã€‚</p>
                    </div>

                    <!-- 2. ç™½è©±ç¿»è­¯ -->
                    <div class="explain-section">
                        <h4>ğŸ’¡ ç¬¬äºŒæ­¥ï¼šç™½è©±ç¿»è­¯</h4>
                        <p>å“ªä¸€å€‹é¸é …<strong>ã€Œä¸æ˜¯ SIEM çœŸæ­£çš„èƒ½åŠ›æè¿°ã€</strong>ï¼Ÿï¼ˆè¦æŠŠ SIEM æœ€å²å®³çš„åœ°æ–¹èªªæˆæ²’æœ‰ï¼Œé‚£è‚¯å®šéŒ¯ã€‚ï¼‰</p>
                    </div>

                    <!-- 3. è§£é¡Œæ€è·¯ -->
                    <div class="explain-section">
                        <h4>ğŸ§  ç¬¬ä¸‰æ­¥ï¼šè§£é¡Œæ€è·¯</h4>
                        <span class="sub-header">ã€åŸç†èˆ‡è¦å‰‡ã€‘</span>
                        <p>SIEM (Security Information and Event Management) çš„æœ€å¤§åƒ¹å€¼å°±æ˜¯æŠŠåˆ†æ•£çš„ Log é›†ä¸­èµ·ä¾†ï¼Œé€²è¡Œ<strong>ã€Œé—œè¯åˆ†æã€</strong>ï¼ˆä¾‹å¦‚ï¼šé–€ç¦å¡åˆ·å¡ + é›»è…¦ç™»å…¥ = ç•°å¸¸ï¼‰ã€‚</p>
                        
                        <span class="sub-header">ã€ç”Ÿæ´»ä¾‹å­ã€‘</span>
                        <p>æƒ³åƒä¸€å€‹<strong>ç¤¾å€è­¦è¡›å®¤ï¼ˆSIEMï¼‰</strong>ã€‚å¦‚æœå®ƒåªæœƒæ”¶ä¿¡ï¼ˆLogï¼‰ï¼Œé‚£æ²’ç”¨ã€‚å®ƒçš„åƒ¹å€¼åœ¨æ–¼ç™¼ç¾ã€Œ3è™Ÿä½æˆ¶æ˜æ˜å‡ºåœ‹äº†ï¼ˆLog Aï¼‰ï¼Œç‚ºä»€éº¼ä»–å®¶ç‡ˆå»äº®äº†ï¼ˆLog Bï¼‰ï¼Ÿã€é€™å°±æ˜¯é—œè¯åˆ†æã€‚</p>
                    </div>

                    <!-- 4. é¸é …åˆ†æ -->
                    <div class="explain-section">
                        <h4>âš–ï¸ ç¬¬å››æ­¥ï¼šé¸é …åˆ†æ</h4>
                        <ul>
                            <li><strong>(A) æ­£ç¢ºï¼š</strong>SIEM æœ¬ä¾†å°±è’é›† logsã€alertsã€‚</li>
                            <li><strong>(B) æ­£ç¢ºï¼š</strong>åŒ¯èšè³‡æ–™ä¸¦åˆ†ææ˜¯æ ¸å¿ƒåŠŸèƒ½ã€‚</li>
                            <li><strong>(C) éŒ¯èª¤ï¼š</strong>SIEM æ°æ°å°±æ˜¯åšé€™äº›åˆ†æçš„ï¼Œèªªå®ƒã€Œç¼ºä¹ã€å°±åƒèªªè·‘è»Šç¼ºä¹å¼•æ“ä¸€æ¨£ã€‚</li>
                            <li><strong>(D) æ­£ç¢ºï¼š</strong>å±¬æ–¼ SIEM çš„æ¨™æº–èª¿æŸ¥å–è­‰åŠŸèƒ½ã€‚</li>
                        </ul>
                    </div>

                    <!-- 5. è§€å¿µè£œå……èˆ‡å»¶ä¼¸ -->
                    <div class="explain-section">
                        <h4>ğŸ›¡ï¸ è§€å¿µè£œå……èˆ‡å»¶ä¼¸</h4>
                        
                        <span class="sub-header">ã€è§¸é¡æ—é€šã€‘</span>
                        <p>Log Server åªæ˜¯å€‰åº«ï¼ˆå­˜è³‡æ–™ï¼‰ï¼ŒSIEM æ˜¯å¤§è…¦ï¼ˆåˆ†æè³‡æ–™ï¼‰ã€‚</p>

                        <span class="sub-header">ã€è¨˜æ†¶å£è¨£ã€‘</span>
                        <p>ã€ŒSIEM æœ€æœƒåšçš„ï¼Œå°±æ˜¯é—œè¯åˆ†æã€‚ã€</p>

                        <span class="sub-header">ã€å¸¸è¦‹é™·é˜±ã€‘</span>
                        <p>ä»¥ç‚º SIEM åªæ˜¯ç”¨ä¾†å­˜ Log æ‡‰ä»˜ç¨½æ ¸çš„ï¼ˆé‚£æ˜¯ Log Managementï¼‰ã€‚</p>

                        <span class="sub-header">ã€é¿å‘æŒ‡å—ã€‘</span>
                        <p>çœ‹åˆ°é¸é …èªªæŸå€‹å°ˆæ¥­å·¥å…·<strong>ã€Œç¼ºä¹å®ƒçš„æ ¸å¿ƒåŠŸèƒ½ã€</strong>ï¼Œé‚£é€šå¸¸å°±æ˜¯ç­”æ¡ˆã€‚</p>
                    </div>
                `,
                selfCheck: {
                    q: "SIEM è·Ÿ Log Server æœ€å¤§çš„å·®åˆ¥æ˜¯ä»€éº¼ï¼Ÿ",
                    a: "Log Server åªæ˜¯å­˜æ—¥èªŒï¼›SIEM èƒ½åšã€Œé—œè¯åˆ†æã€èˆ‡ã€Œå³æ™‚å‘Šè­¦ã€ã€‚"
                }
            },
            {
                id: 3,
                originalNum: 27,
                type: "single",
                tags: ["tag-sec", "tag-mgm"],
                question: "é—œæ–¼ SOARï¼Œä¸‹åˆ—ä½•é …æœ€ã€Œä¸ã€æ˜¯å…¶å…·å‚™çš„åŠŸèƒ½ï¼Ÿ",
                options: [
                    { id: "A", text: "å®‰å…¨ç·¨æ’ï¼ˆOrchestrationï¼‰" },
                    { id: "B", text: "å®‰å…¨è¨­è¨ˆï¼ˆSecurity Designï¼‰" },
                    { id: "C", text: "è‡ªå‹•åŒ–ï¼ˆAutomationï¼‰" },
                    { id: "D", text: "å³æ™‚å›æ‡‰ï¼ˆResponseï¼‰" }
                ],
                correctAnswer: ["B"],
                reason: "SOAR = Security Orchestration, Automation and Responseã€‚è¨­è¨ˆï¼ˆDesignï¼‰å±¬æ–¼æ¶æ§‹éšæ®µï¼Œé SOAR åŠŸèƒ½ã€‚",
                explanation: `
                    <!-- 1. æ‰¾é—œéµå­— -->
                    <div class="explain-section">
                        <h4>ğŸ” ç¬¬ä¸€æ­¥ï¼šæ‰¾é—œéµå­—</h4>
                        <p>SOARã€æœ€ã€Œä¸ã€æ˜¯ã€ç·¨æ’ã€è‡ªå‹•åŒ–ã€å›æ‡‰ã€è¨­è¨ˆã€‚</p>
                    </div>

                    <!-- 2. ç™½è©±ç¿»è­¯ -->
                    <div class="explain-section">
                        <h4>ğŸ’¡ ç¬¬äºŒæ­¥ï¼šç™½è©±ç¿»è­¯</h4>
                        <p>SOAR é€™å€‹å·¥å…·<strong>ä¸è² è²¬ã€Œå“ªä¸€ä»¶äº‹ã€</strong>ï¼Ÿ</p>
                    </div>

                    <!-- 3. è§£é¡Œæ€è·¯ -->
                    <div class="explain-section">
                        <h4>ğŸ§  ç¬¬ä¸‰æ­¥ï¼šè§£é¡Œæ€è·¯</h4>
                        <span class="sub-header">ã€åŸç†èˆ‡è¦å‰‡ã€‘</span>
                        <p>SOAR çš„å…¨åç›´æ¥å‘Šè¨´ä½ ç­”æ¡ˆï¼šSecurity <strong>Orchestration</strong>, <strong>Automation</strong> and <strong>Response</strong>ã€‚è£¡é¢æ²’æœ‰ Designã€‚</p>
                        
                        <span class="sub-header">ã€ç”Ÿæ´»ä¾‹å­ã€‘</span>
                        <p>SOAR åƒæ˜¯<strong>ã€Œæ™ºæ…§å®¶åº­ä¸­æ§ã€</strong>ï¼ˆæœ‰äººé—–å…¥ -> è‡ªå‹•é–é–€ -> è‡ªå‹•å ±è­¦ï¼‰ã€‚ä½†å®ƒä¸è² è²¬ã€Œè“‹æˆ¿å­ï¼ˆDesignï¼‰ã€ã€‚</p>
                    </div>

                    <!-- 4. é¸é …åˆ†æ -->
                    <div class="explain-section">
                        <h4>âš–ï¸ ç¬¬å››æ­¥ï¼šé¸é …åˆ†æ</h4>
                        <ul>
                            <li><strong>(A) ç·¨æ’ (Orchestration)ï¼š</strong>æ­£ç¢ºï¼ŒæŠŠé˜²ç«ç‰†ã€é˜²æ¯’ç­‰å·¥å…·ä¸²èµ·ä¾†ï¼ˆåƒæ¨‚åœ˜æŒ‡æ®ï¼‰ã€‚</li>
                            <li><strong>(B) è¨­è¨ˆ (Design)ï¼š</strong>éŒ¯èª¤ï¼Œé€™æ˜¯æ¶æ§‹å¸«åœ¨ç³»çµ±é–‹ç™¼å‰åšçš„äº‹ã€‚</li>
                            <li><strong>(C) è‡ªå‹•åŒ– (Automation)ï¼š</strong>æ­£ç¢ºï¼Œè‡ªå‹•åŸ·è¡Œé‡è¤‡å·¥ä½œï¼ˆåƒæ©Ÿå™¨äººï¼‰ã€‚</li>
                            <li><strong>(D) å›æ‡‰ (Response)ï¼š</strong>æ­£ç¢ºï¼Œå°äº‹ä»¶åšå‡ºåæ‡‰ï¼ˆå¦‚è‡ªå‹•å°é– IPï¼‰ã€‚</li>
                        </ul>
                    </div>

                    <!-- 5. è§€å¿µè£œå……èˆ‡å»¶ä¼¸ -->
                    <div class="explain-section">
                        <h4>ğŸ›¡ï¸ è§€å¿µè£œå……èˆ‡å»¶ä¼¸</h4>
                        
                        <span class="sub-header">ã€è¨˜æ†¶å£è¨£ã€‘</span>
                        <p>ã€ŒSOAR ä¸‰å…„å¼Ÿï¼šç·¨æ’ï¼ˆOï¼‰ã€è‡ªå‹•åŒ–ï¼ˆAï¼‰ã€å›æ‡‰ï¼ˆRï¼‰ã€‚ã€</p>

                        <span class="sub-header">ã€å¿ƒç†ç›²é»ã€‘</span>
                        <p>çœ‹åˆ° Security é–‹é ­çš„å­—å°±è¦ºå¾—éƒ½ç›¸é—œï¼Œå¿½ç•¥äº†è‹±æ–‡ç¸®å¯«çš„å®šç¾©ã€‚</p>

                        <span class="sub-header">ã€é¿å‘æŒ‡å—ã€‘</span>
                        <p>ç¸®å¯«é¡Œå‹ï¼Œè«‹å‹™å¿…é‚„åŸè‹±æ–‡å…¨æ–‡ï¼Œç­”æ¡ˆé€šå¸¸å°±åœ¨åå­—è£¡ã€‚</p>
                    </div>
                `,
                selfCheck: {
                    q: "SOAR ä¸»è¦æ˜¯ç‚ºäº†è§£æ±ºä»€éº¼å•é¡Œï¼Ÿ",
                    a: "è³‡å®‰äººåŠ›ä¸è¶³ï¼ˆå‘Šè­¦ç–²å‹ Alert Fatigueï¼‰èˆ‡å›æ‡‰é€Ÿåº¦å¤ªæ…¢ã€‚"
                }
            },
            {
                id: 4,
                originalNum: 28,
                type: "multiple",
                tags: ["tag-mgm"],
                question: "ã€è¤‡é¸é¡Œã€‘ç¾ä»£åŒ–å®‰å…¨ç¶­é‹æ¨¡å¼ï¼ˆSecOpsï¼‰çš„é—œéµå…ƒç´ ç‚ºä½•ï¼Ÿ",
                options: [
                    { id: "A", text: "SIEM" },
                    { id: "B", text: "SOAR" },
                    { id: "C", text: "SSDLC" },
                    { id: "D", text: "å¨è„…æƒ…è³‡ï¼ˆThreat Intelligenceï¼‰" }
                ],
                correctAnswer: ["A", "B", "D"],
                reason: "SecOps å¼·èª¿ç¶­é‹ä¸­çš„åµæ¸¬ï¼ˆSIEMï¼‰ã€å›æ‡‰ï¼ˆSOARï¼‰èˆ‡é è­¦ï¼ˆæƒ…è³‡ï¼‰ã€‚SSDLC å±¬æ–¼é–‹ç™¼æµç¨‹ã€‚",
                explanation: `
                    <!-- 1. æ‰¾é—œéµå­— -->
                    <div class="explain-section">
                        <h4>ğŸ” ç¬¬ä¸€æ­¥ï¼šæ‰¾é—œéµå­—</h4>
                        <p>SecOpsã€ç¾ä»£åŒ–ã€é—œéµå…ƒç´ ã€è¤‡é¸ã€‚</p>
                    </div>

                    <!-- 2. ç™½è©±ç¿»è­¯ -->
                    <div class="explain-section">
                        <h4>ğŸ’¡ ç¬¬äºŒæ­¥ï¼šç™½è©±ç¿»è­¯</h4>
                        <p>ç¾ä»£åŒ–çš„è³‡å®‰ç¶­é‹ä¸­å¿ƒï¼Œé€šå¸¸æœƒé å“ªäº›<strong>ã€Œæ ¸å¿ƒæ‹¼åœ–ã€</strong>ä¾†é‹ä½œï¼Ÿ</p>
                    </div>

                    <!-- 3. è§£é¡Œæ€è·¯ -->
                    <div class="explain-section">
                        <h4>ğŸ§  ç¬¬ä¸‰æ­¥ï¼šè§£é¡Œæ€è·¯</h4>
                        <span class="sub-header">ã€åŸç†èˆ‡è¦å‰‡ã€‘</span>
                        <p>SecOps çš„é»ƒé‡‘ä¸‰è§’ï¼š</p>
                        <ol>
                            <li><strong>çœ‹å¾—è¦‹ï¼ˆåµæ¸¬ï¼‰ï¼š</strong>SIEMï¼ˆæ•´åˆèˆ‡åˆ†æï¼‰ã€‚</li>
                            <li><strong>å‹•å¾—å¿«ï¼ˆå›æ‡‰ï¼‰ï¼š</strong>SOARï¼ˆè‡ªå‹•åŒ–å›æ‡‰ï¼‰ã€‚</li>
                            <li><strong>æ—©çŸ¥é“ï¼ˆé è­¦ï¼‰ï¼š</strong>å¨è„…æƒ…è³‡ï¼ˆå¤–éƒ¨æƒ…å ±ï¼‰ã€‚</li>
                        </ol>
                        
                        <span class="sub-header">ã€ç”Ÿæ´»ä¾‹å­ã€‘</span>
                        <p>ç¾ä»£åŒ–æˆ°çˆ­æŒ‡æ®ä¸­å¿ƒï¼šéœ€è¦<strong>é›·é”ï¼ˆSIEMï¼‰</strong>ã€<strong>è‡ªå‹•é˜²ç¦¦ç³»çµ±ï¼ˆSOARï¼‰</strong>ä»¥åŠ<strong>æ•µè»æƒ…å ±ï¼ˆæƒ…è³‡ï¼‰</strong>ã€‚è‡³æ–¼ã€Œè£½é€ æ­¦å™¨çš„æµç¨‹ï¼ˆSSDLCï¼‰ã€å‰‡å±¬æ–¼å¾Œå‹¤å·¥å» ï¼Œä¸åœ¨æˆ°å ´æŒ‡æ®ä¸­å¿ƒå…§ã€‚</p>
                    </div>

                    <!-- 4. é¸é …åˆ†æ -->
                    <div class="explain-section">
                        <h4>âš–ï¸ ç¬¬å››æ­¥ï¼šé¸é …åˆ†æ</h4>
                        <ul>
                            <li><strong>(A) SIEMï¼š</strong>æ­£ç¢ºï¼Œè² è²¬åµæ¸¬èˆ‡åˆ†æã€‚</li>
                            <li><strong>(B) SOARï¼š</strong>æ­£ç¢ºï¼Œè² è²¬è‡ªå‹•åŒ–æ‡‰è®Šã€‚</li>
                            <li><strong>(C) SSDLCï¼š</strong>ä¸é¸ï¼Œé€™æ˜¯ã€Œå®‰å…¨è»Ÿé«”é–‹ç™¼ç”Ÿå‘½é€±æœŸã€ï¼Œå±¬æ–¼ DevSecOps çš„é–‹ç™¼éšæ®µï¼Œéç¶­é‹æ ¸å¿ƒã€‚</li>
                            <li><strong>(D) å¨è„…æƒ…è³‡ï¼š</strong>æ­£ç¢ºï¼Œæä¾›å¤–éƒ¨æ”»æ“Šæƒ…å ±ã€‚</li>
                        </ul>
                    </div>

                    <!-- 5. è§€å¿µè£œå……èˆ‡å»¶ä¼¸ -->
                    <div class="explain-section">
                        <h4>ğŸ›¡ï¸ è§€å¿µè£œå……èˆ‡å»¶ä¼¸</h4>
                        
                        <span class="sub-header">ã€è¨˜æ†¶å£è¨£ã€‘</span>
                        <p>ã€ŒSecOpsï¼šçœ‹å¾—è¦‹ï¼ˆSIEMï¼‰ã€å‹•å¾—å¿«ï¼ˆSOARï¼‰ã€æ—©çŸ¥é“ï¼ˆæƒ…è³‡ï¼‰ã€‚ã€</p>

                        <span class="sub-header">ã€å¸¸è¦‹é™·é˜±ã€‘</span>
                        <p>æ··æ·† SecOpsï¼ˆç¶­é‹ï¼‰èˆ‡ DevSecOpsï¼ˆé–‹ç™¼ï¼‰ã€‚SSDLC æ˜¯é–‹ç™¼çš„äº‹ã€‚</p>

                        <span class="sub-header">ã€è‡ªæˆ‘æª¢æ¸¬èˆ‡åæ€ã€‘</span>
                        <p>æ²’æœ‰æƒ…è³‡çš„ SOC æœƒæœ‰ä»€éº¼å•é¡Œï¼Ÿåªèƒ½è¢«å‹•æŒ¨æ‰“ï¼Œä¸çŸ¥é“å¤–é¢æµè¡Œä»€éº¼æ–°ç—…æ¯’ã€‚</p>
                    </div>
                `,
                selfCheck: {
                    q: "æ²’æœ‰æƒ…è³‡ï¼ˆIntelï¼‰çš„ SOC æœƒæœ‰ä»€éº¼å•é¡Œï¼Ÿ",
                    a: "åªèƒ½è¢«å‹•æŒ¨æ‰“ï¼Œä¸çŸ¥é“å¤–é¢æµè¡Œä»€éº¼æ”»æ“Šæ‰‹æ³•ï¼Œç„¡æ³•æå‰é˜²ç¦¦ã€‚"
                }
            }
        ]
    };

    // --- ç‹€æ…‹ç®¡ç† ---
    const appState = {
        answers: {}, // { 1: ['A'], 2: ['B', 'C'] }
        status: {},  // { 1: 'correct', 2: 'wrong' }
        completed: new Set()
    };

    // --- åˆå§‹åŒ–èˆ‡æ¸²æŸ“ ---
    function initApp() {
        renderTabs();
        renderQuestions();
        updateProgress();
        
        // é è¨­é¡¯ç¤ºç¬¬ä¸€é¡Œ
        if (quizData.questions.length > 0) {
            switchTab(0);
        }
    }

    function renderTabs() {
        const container = document.getElementById('tabs-container');
        container.innerHTML = quizData.questions.map((q, index) => `
            <button class="tab-btn" onclick="switchTab(${index})" id="tab-${index}">
                Q${q.originalNum || index + 1}
                <span class="tab-status" id="tab-status-${q.id}"></span>
            </button>
        `).join('');
    }

    function renderQuestions() {
        const container = document.getElementById('questions-container');
        container.innerHTML = quizData.questions.map((q, index) => {
            const inputType = q.type === 'single' ? 'radio' : 'checkbox';
            const tagSpan = q.tags ? `<span class="tag ${q.tags[0]}">è§€å¿µé¡Œ</span>` : '';
            
            return `
            <div class="tab-content" id="content-${index}">
                <!-- å–®é¡Œ Header -->
                <div class="question-header">
                    <span class="q-badge" id="q-badge-${q.id}">æœªä½œç­”</span>
                    ${tagSpan}
                </div>

                <!-- é¡Œç›®æ•˜è¿° -->
                <div class="question-text">
                    ${q.originalNum}. ${q.question}
                </div>

                <!-- é¸é …å€åŸŸ -->
                <div class="options-list" id="options-list-${q.id}">
                    ${q.options.map(opt => `
                        <div class="option" onclick="handleOptionClick(${q.id}, '${opt.id}', '${q.type}')" id="opt-${q.id}-${opt.id}">
                            <input type="${inputType}" name="q${q.id}" value="${opt.id}">
                            <div class="option-text">
                                <strong>(${opt.id})</strong> ${opt.text}
                            </div>
                        </div>
                    `).join('')}
                </div>

                <!-- æŒ‰éˆ•å€åŸŸ -->
                <div class="action-area">
                    <button class="btn btn-primary" id="btn-submit-${q.id}" onclick="submitAnswer(${q.id})">é€å‡ºç­”æ¡ˆ</button>
                </div>

                <!-- å›é¥‹å€åŸŸ (é è¨­éš±è—) -->
                <div class="feedback" id="feedback-${q.id}"></div>

                <!-- è©³ç´°è§£æ (é è¨­éš±è—) -->
                <details id="explain-${q.id}" style="display:none">
                    <summary>ğŸ“– æŸ¥çœ‹è©³ç´°è§£æ</summary>
                    <div class="details-content">
                        ${q.explanation}
                    </div>
                </details>

                <!-- è‡ªæˆ‘æª¢æ¸¬ (é¡Œç›®é¡¯ç¤ºï¼Œç­”æ¡ˆéš±è—) -->
                <div id="selfcheck-${q.id}" class="self-check-container">
                    <p class="self-check-q">ğŸ¤” è‡ªæˆ‘æª¢æ¸¬ï¼š${q.selfCheck.q}</p>
                    <details class="self-check-details">
                        <summary>é»æ“ŠæŸ¥çœ‹åƒè€ƒè§£ç­”</summary>
                        <div class="details-content">
                            ${q.selfCheck.a}
                        </div>
                    </details>
                </div>
            </div>
            `;
        }).join('');
    }

    // --- äº’å‹•é‚è¼¯ ---

    function switchTab(index) {
        // 1. éš±è—æ‰€æœ‰å…§å®¹
        document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));

        // 2. é¡¯ç¤ºç›®æ¨™
        document.getElementById(`content-${index}`).classList.add('active');
        document.getElementById(`tab-${index}`).classList.add('active');

        // 3. å¹³æ»‘æ²å‹•å›é ‚ç«¯ (UX)
        const container = document.getElementById(`content-${index}`);
        if(container) {
            container.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
    }

    function handleOptionClick(qId, optId, type) {
        // å¦‚æœå·²æäº¤ï¼Œç¦æ­¢ä¿®æ”¹
        if (appState.completed.has(qId)) return;

        const container = document.getElementById(`options-list-${qId}`);
        const inputs = container.querySelectorAll('input');
        const options = container.querySelectorAll('.option');

        if (type === 'single') {
            // å–®é¸ï¼šæ¸…é™¤å…¶ä»–ï¼Œé¸ä¸­ç•¶å‰
            inputs.forEach(input => input.checked = false);
            options.forEach(opt => opt.classList.remove('selected'));
            
            const targetInput = container.querySelector(`input[value="${optId}"]`);
            const targetDiv = document.getElementById(`opt-${qId}-${optId}`);
            
            targetInput.checked = true;
            targetDiv.classList.add('selected');
        } else {
            // è¤‡é¸ï¼šåˆ‡æ›ç‹€æ…‹
            const targetInput = container.querySelector(`input[value="${optId}"]`);
            const targetDiv = document.getElementById(`opt-${qId}-${optId}`);
            
            targetInput.checked = !targetInput.checked;
            if (targetInput.checked) {
                targetDiv.classList.add('selected');
            } else {
                targetDiv.classList.remove('selected');
            }
        }
    }

    function submitAnswer(qId) {
        // 1. ç²å–ç”¨æˆ¶é¸æ“‡
        const container = document.getElementById(`options-list-${qId}`);
        const checkedInputs = Array.from(container.querySelectorAll('input:checked'));
        
        if (checkedInputs.length === 0) {
            alert("è«‹å…ˆé¸æ“‡ä¸€å€‹ç­”æ¡ˆï¼");
            return;
        }

        const userAnswers = checkedInputs.map(input => input.value).sort();
        const questionData = quizData.questions.find(q => q.id === qId);
        const correctAnswers = questionData.correctAnswer.sort();

        // 2. åˆ¤å®šå°éŒ¯
        const isCorrect = JSON.stringify(userAnswers) === JSON.stringify(correctAnswers);

        // 3. æ›´æ–°ç‹€æ…‹èˆ‡ UI
        appState.completed.add(qId);
        appState.status[qId] = isCorrect ? 'correct' : 'wrong';

        // ç¦ç”¨é¸é …
        container.querySelectorAll('.option').forEach(opt => {
            opt.classList.add('disabled');
            opt.onclick = null; // ç§»é™¤é»æ“Šäº‹ä»¶
        });
        container.querySelectorAll('input').forEach(inp => inp.disabled = true);

        // é¡¯ç¤º Badge
        const badge = document.getElementById(`q-badge-${qId}`);
        badge.className = `q-badge ${isCorrect ? 'status-correct' : 'status-wrong'}`;
        badge.textContent = isCorrect ? 'ç­”å°' : 'ç­”éŒ¯';

        // Tab ç‹€æ…‹æ¨™è¨˜
        const tabStatus = document.getElementById(`tab-status-${qId}`);
        tabStatus.textContent = isCorrect ? 'âœ“' : 'âœ—';
        tabStatus.style.color = isCorrect ? 'var(--success-text)' : 'var(--error-text)';

        // é¡¯ç¤ºå›é¥‹
        const feedbackDiv = document.getElementById(`feedback-${qId}`);
        feedbackDiv.style.display = 'block';
        feedbackDiv.className = `feedback ${isCorrect ? 'success' : 'error'}`;
        
        if (isCorrect) {
            feedbackDiv.innerHTML = `<strong>âœ“ ç­”å°äº†ï¼</strong><p>${questionData.reason}</p>`;
        } else {
            feedbackDiv.innerHTML = `
                <strong>âœ— ç­”éŒ¯äº†</strong>
                <p>æ­£ç¢ºç­”æ¡ˆï¼š${correctAnswers.join('ã€')}</p>
                <p>${questionData.reason}</p>
            `;
        }

        // é¡¯ç¤ºè§£æèˆ‡è‡ªæª¢ (Q é¡¯ç¤º, A éœ€é»æ“Š)
        document.getElementById(`explain-${qId}`).style.display = 'block';
        document.getElementById(`selfcheck-${qId}`).style.display = 'block';

        // æŒ‰éˆ•è®Šç‚ºé‡æ–°ä½œç­”
        const btn = document.getElementById(`btn-submit-${qId}`);
        btn.textContent = 'é‡æ–°ä½œç­”';
        btn.className = 'btn btn-reset';
        btn.onclick = () => resetQuestion(qId);

        updateProgress();
    }

    function resetQuestion(qId) {
        // 1. æ¸…é™¤ç‹€æ…‹
        appState.completed.delete(qId);
        delete appState.status[qId];

        const questionData = quizData.questions.find(q => q.id === qId);

        // 2. UI é‡ç½®
        const container = document.getElementById(`options-list-${qId}`);
        container.querySelectorAll('.option').forEach(opt => {
            opt.classList.remove('disabled', 'selected');
            // æ¢å¾©é»æ“Šäº‹ä»¶
            const val = opt.querySelector('input').value;
            opt.setAttribute('onclick', `handleOptionClick(${qId}, '${val}', '${questionData.type}')`);
        });
        container.querySelectorAll('input').forEach(inp => {
            inp.disabled = false;
            inp.checked = false;
        });

        // éš±è—å›é¥‹èˆ‡è§£æ
        document.getElementById(`feedback-${qId}`).style.display = 'none';
        const explain = document.getElementById(`explain-${qId}`);
        explain.style.display = 'none';
        explain.removeAttribute('open'); // æ”¶åˆ
        
        const selfcheck = document.getElementById(`selfcheck-${qId}`);
        selfcheck.style.display = 'none';
        selfcheck.querySelector('details').removeAttribute('open'); // æ”¶åˆç­”æ¡ˆ

        // Badge é‡ç½®
        const badge = document.getElementById(`q-badge-${qId}`);
        badge.className = 'q-badge';
        badge.textContent = 'æœªä½œç­”';

        // Tab é‡ç½®
        document.getElementById(`tab-status-${qId}`).textContent = '';

        // æŒ‰éˆ•é‡ç½®
        const btn = document.getElementById(`btn-submit-${qId}`);
        btn.textContent = 'é€å‡ºç­”æ¡ˆ';
        btn.className = 'btn btn-primary';
        btn.setAttribute('onclick', `submitAnswer(${qId})`);

        updateProgress();
    }

    function updateProgress() {
        const total = quizData.questions.length;
        const completed = appState.completed.size;
        const percent = Math.round((completed / total) * 100);

        document.getElementById('progress-text').innerHTML = `å·²å®Œæˆï¼š<strong>${completed}</strong> / ${total}`;
        document.getElementById('progress-fill').style.width = `${percent}%`;

        const statusText = document.getElementById('status-text');
        if (completed === total) {
            statusText.textContent = 'âœ… æœ¬é¡Œçµ„å·²å®Œæˆ';
            statusText.className = 'status-done';
        } else {
            statusText.textContent = 'ğŸ“ å°šæœªå®Œæˆ';
            statusText.className = 'status-pending';
        }
    }

    // å•Ÿå‹•æ‡‰ç”¨
    window.onload = initApp;

</script>
</body>
</html>