<!-- filename: ipas_risk_response_q36_interactive.html -->
<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iPAS é¢¨éšªå›æ‡‰ç­–ç•¥ï¼ˆRisk Responseï¼‰â€” ç¬¬ 36 é¡Œäº’å‹•æ•™å­¸</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --accent-color: #3498db;
            --success-color: #27ae60;
            --error-color: #c0392b;
            --bg-color: #f8f9fa;
            --card-bg: #ffffff;
            --text-color: #333333;
            --border-radius: 8px;
            --highlight-color: #fff3cd;
        }

        body {
            font-family: "Microsoft JhengHei", "Heiti TC", sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        /* Header */
        header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
        }

        h1 {
            color: var(--primary-color);
            font-size: 1.8rem;
            margin: 0;
        }

        h2 {
            font-size: 1.4rem;
            color: var(--accent-color);
            margin-top: 0;
            border-left: 5px solid var(--accent-color);
            padding-left: 10px;
            margin-bottom: 15px;
        }

        h3 {
            font-size: 1.2rem;
            color: var(--primary-color);
            margin-top: 20px;
            border-bottom: 1px dashed #ccc;
            padding-bottom: 5px;
        }

        /* Cards */
        .card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
        }

        /* Question Section */
        .question-text {
            font-size: 1.15rem;
            font-weight: 500;
            margin-bottom: 20px;
        }

        .keyword {
            cursor: pointer;
            padding: 2px 4px;
            border-radius: 4px;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }

        .keyword:hover {
            background-color: #e9ecef;
        }

        .keyword.active {
            background-color: var(--highlight-color);
            border-bottom-color: var(--accent-color);
            font-weight: bold;
            color: #856404;
        }

        .keyword-hint {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 15px;
            font-style: italic;
        }

        /* Options */
        .options-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option-label {
            display: flex;
            align-items: flex-start;
            cursor: pointer;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            transition: background 0.2s;
        }

        .option-label:hover {
            background-color: #f1f8ff;
        }

        .option-label input[type="checkbox"] {
            margin-right: 12px;
            margin-top: 5px;
            transform: scale(1.2);
        }

        /* Controls */
        .btn {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: var(--border-radius);
            font-size: 1rem;
            cursor: pointer;
            transition: opacity 0.2s;
            margin-top: 20px;
            display: inline-block;
        }

        .btn:hover {
            opacity: 0.9;
        }

        .btn.disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        /* Feedback */
        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: var(--border-radius);
            display: none;
            font-weight: bold;
        }

        .feedback.success {
            display: block;
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .feedback.error {
            display: block;
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        /* Analysis Section */
        #analysis-section {
            display: none;
        }

        .step-block {
            margin-bottom: 20px;
            padding-left: 15px;
            border-left: 3px solid #ddd;
        }

        .step-block strong {
            color: var(--primary-color);
            display: block;
            margin-bottom: 5px;
        }

        .highlight-red {
            color: var(--error-color);
            font-weight: bold;
        }

        .highlight-green {
            color: var(--success-color);
            font-weight: bold;
        }

        /* Self Check */
        .spoiler-btn {
            background-color: #eee;
            border: 1px solid #ccc;
            color: #333;
            padding: 5px 10px;
            font-size: 0.9rem;
            cursor: pointer;
            margin-top: 5px;
        }
        
        .spoiler-content {
            display: none;
            margin-top: 10px;
            padding: 10px;
            background-color: #f8f9fa;
            border-left: 3px solid var(--success-color);
        }

        /* Glossary */
        .glossary-item {
            margin-bottom: 10px;
        }
        .glossary-term {
            font-weight: bold;
            color: var(--primary-color);
        }

        /* Footer */
        footer {
            text-align: center;
            margin-top: 40px;
            color: #777;
            font-size: 0.9rem;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>iPAS é¢¨éšªå›æ‡‰ç­–ç•¥ï¼ˆRisk Responseï¼‰</h1>
        <p>ç¬¬ 36 é¡Œäº’å‹•æ•™å­¸ â€” å°ˆç‚ºé«˜ä¸­ç”Ÿè¨­è¨ˆçš„è³‡å®‰å…¥é–€èª²</p>
    </header>

    <!-- Question Card -->
    <div class="card" id="question-card">
        <h2>ã€é¡Œç›® 36ã€‘</h2>
        <div class="keyword-hint">æç¤ºï¼šé»æ“Šé¡Œç›®ä¸­çš„æ–‡å­—å¯æ¨™è¨˜ã€Œé—œéµå­—ã€ï¼Œå¹«åŠ©ä½ æ‹†è§£é¡Œæ„ã€‚</div>
        <div class="question-text" id="question-text">
            <!-- Content will be injected by JS -->
        </div>
        
        <div class="options-group" id="options-container">
            <!-- Options will be injected by JS -->
        </div>

        <button id="submit-btn" class="btn">é€å‡ºç­”æ¡ˆ</button>
        <div id="feedback-area" class="feedback"></div>
    </div>

    <!-- Analysis/Teaching Card -->
    <div class="card" id="analysis-section">
        <h2>è§£æèˆ‡è§€å¿µæ•™å­¸</h2>
        
        <div id="analysis-content">
            <!-- Content will be injected by JS -->
        </div>
    </div>

    <!-- Self Check Card -->
    <div class="card">
        <h2>è‡ªæˆ‘æª¢æ¸¬</h2>
        <p>è©¦è‘—å›ç­”ä»¥ä¸‹å•é¡Œï¼Œç¢ºèªè§€å¿µæ˜¯å¦é‡æ¸…ï¼ˆé»æ“ŠæŒ‰éˆ•æŸ¥çœ‹ç­”æ¡ˆï¼‰ï¼š</p>
        <div id="self-check-container">
            <!-- Content will be injected by JS -->
        </div>
    </div>

    <!-- Footer / Glossary -->
    <div class="card">
        <h2>åè©å°å­—å…¸</h2>
        <div id="glossary-container">
            <!-- Content will be injected by JS -->
        </div>
    </div>

    <footer>
        <p>iPAS è³‡è¨Šå®‰å…¨è¦åŠƒå¯¦å‹™ / è³‡è¨Šå®‰å…¨é˜²è­·å¯¦å‹™ â€” è¡åˆºæ•™æ</p>
    </footer>
</div>

<script>
    // ---------------------------------------------------------
    // Data Management
    // ---------------------------------------------------------
    const questionData = {
        id: 36,
        // Using spans for interactivity handled in render
        textSegments: [
            { text: "X å…¬å¸èˆ‡ Y å…¬å¸é€²è¡Œ", type: "normal" },
            { text: "ç¶²è·¯æœå‹™æ¥­å‹™åˆä½œ", type: "keyword" },
            { text: "ä¹‹", type: "normal" },
            { text: "é¢¨éšªè¶…é", type: "keyword" },
            { text: "å…¬å¸æ‰€è¨­å®šä¹‹", type: "normal" },
            { text: "é¢¨éšªèƒƒç´ï¼ˆRisk appetiteï¼Œå…¬å¸é¡˜æ„æ‰¿æ“”é¢¨éšªçš„æœ€é«˜å®¹å¿ç¨‹åº¦ï¼‰", type: "keyword" },
            { text: "ã€‚X å…¬å¸", type: "normal" },
            { text: "æœ€å¾Œæ±ºå®š", type: "keyword" },
            { text: "èˆ‡ Y å…¬å¸", type: "normal" },
            { text: "é€²è¡Œåˆä½œ", type: "keyword" },
            { text: "ï¼Œä¸‹åˆ—å“ªäº›é …ç›®æ˜¯åˆé©çš„é¢¨éšªå›æ‡‰é¸æ“‡ï¼Ÿï¼ˆè¤‡é¸ï¼‰", type: "normal" }
        ],
        options: [
            { id: "A", text: "é¢¨éšªè¦é¿ï¼ˆRisk avoidanceï¼Œå®Œå…¨é¿é–‹é¢¨éšªä¾†æºï¼Œä¸åšå°è‡´é¢¨éšªçš„æ´»å‹•ï¼‰" },
            { id: "B", text: "é¢¨éšªä¿ç•™ï¼ˆRisk retentionï¼Œæ¥å—é¢¨éšªå­˜åœ¨ï¼Œä¸æ¡å–é¡å¤–è¡Œå‹•ï¼‰" },
            { id: "C", text: "é¢¨éšªç·©è§£ï¼ˆRisk mitigationï¼Œæ¡å–æªæ–½é™ä½é¢¨éšªç™¼ç”Ÿçš„æ©Ÿç‡æˆ–è¡æ“Šï¼‰" },
            { id: "D", text: "é¢¨éšªåˆ†æ“”ï¼ˆRisk sharingï¼Œé€éåˆç´„æˆ–ä¿éšªå°‡éƒ¨åˆ†é¢¨éšªè½‰å«çµ¦ä»–äººï¼‰" }
        ],
        correctAnswers: ["C", "D"],
        analysis: {
            step1: {
                title: "ç¬¬ä¸€æ­¥ï¼šæ‰¾é—œéµå­—",
                content: "ã€Œé¢¨éšªè¶…é...é¢¨éšªèƒƒç´ã€ã€ã€Œæœ€å¾Œæ±ºå®š...é€²è¡Œåˆä½œã€ã€‚é€™å…©å€‹æ¢ä»¶é™åˆ¶äº†æˆ‘å€‘èƒ½é¸æ“‡çš„ç­–ç•¥ã€‚"
            },
            step2: {
                title: "ç¬¬äºŒæ­¥ï¼šç™½è©±ç¿»è­¯",
                content: "é€™ä»¶äº‹çš„é¢¨éšªå¤§åˆ°å…¬å¸å…¶å¯¦ä¸å¤ªèƒ½æ¥å—ï¼ˆè¶…éèƒƒç´ï¼‰ï¼Œä½†è€é—†é‚„æ˜¯æ‹æ¿å®šæ¡ˆè¦å»åšï¼ˆæ±ºå®šåˆä½œï¼‰ã€‚æ—¢ç„¶ä¸€å®šè¦åšï¼Œåˆè¦ºå¾—å±éšªï¼Œè©²æ€éº¼è¾¦ï¼Ÿ"
            },
            step3: {
                title: "ç¬¬ä¸‰æ­¥ï¼šè§£é¡Œæ€è·¯",
                content: `
                    <ol>
                        <li><strong>é¢¨éšªå·²ã€Œè¶…éé¢¨éšªèƒƒç´ã€</strong>ï¼šä»£è¡¨é€™å€‹é¢¨éšªç¨‹åº¦æ˜¯ã€Œä¸å¯æ¥å—çš„ã€ï¼Œæ‰€ä»¥ä¸èƒ½å‡è£æ²’çœ‹åˆ°ï¼ˆä¸èƒ½é¸ B ä¿ç•™ï¼‰ã€‚</li>
                        <li><strong>å…¬å¸ã€Œæœ€å¾Œä»æ±ºå®šåˆä½œã€</strong>ï¼šä»£è¡¨é€™é …æ¥­å‹™å‹¢åœ¨å¿…è¡Œï¼Œä¸èƒ½ç æ‰ä¸åšï¼ˆä¸èƒ½é¸ A è¦é¿ï¼‰ã€‚</li>
                        <li><strong>çµè«–</strong>ï¼šæ—¢ç„¶ä¸èƒ½ä¸åšï¼Œåˆä¸èƒ½ç„¡è¦–ï¼Œåªå‰©ä¸‹å…©æ¢è·¯â€”â€”æƒ³è¾¦æ³•æŠŠé¢¨éšªé™ä½ï¼ˆç·©è§£ï¼‰ï¼Œæˆ–æ˜¯æ‰¾äººä¸€èµ·æ‰›ï¼ˆåˆ†æ“”ï¼‰ã€‚</li>
                    </ol>
                `
            },
            step4: {
                title: "ç¬¬å››æ­¥ï¼šé¸é …åˆ†æ",
                content: `
                    <ul>
                        <li><span class="highlight-red">(A) éŒ¯èª¤</span>ï¼š<strong>é¢¨éšªè¦é¿</strong>çš„æ„æ€æ˜¯ã€Œæ ¹æœ¬ä¸åšé€™ä»¶äº‹ã€ã€‚ä¾‹å¦‚ã€Œè¦ºå¾—é¨è»Šå±éšªï¼Œæ‰€ä»¥æ±ºå®šä¸é¨è»Šã€ã€‚ä½†é¡Œç›®èªªã€Œæ±ºå®šåˆä½œã€ï¼Œæ‰€ä»¥ä¸èƒ½é¸è¦é¿ã€‚</li>
                        <li><span class="highlight-red">(B) éŒ¯èª¤</span>ï¼š<strong>é¢¨éšªä¿ç•™</strong>çš„æ„æ€æ˜¯ã€Œæˆ‘å°±çˆ›ï¼Œé¢¨éšªçµ¦å®ƒå»ã€ã€‚é€šå¸¸åªæœ‰åœ¨ã€Œé¢¨éšªå¾ˆå°ã€æˆ–ã€Œåœ¨èƒƒç´ç¯„åœå…§ã€æ‰æœƒé€™æ¨£åšã€‚é¡Œç›®èªªã€Œè¶…éé¢¨éšªèƒƒç´ã€ï¼Œçµ•å°ä¸èƒ½ç›´æ¥ä¿ç•™ã€‚</li>
                        <li><span class="highlight-green">(C) æ­£ç¢º</span>ï¼š<strong>é¢¨éšªç·©è§£</strong>ã€‚ä¾‹å¦‚åŠ å¼·è³‡å®‰è¨­å‚™ã€åˆ¶å®šåš´æ ¼çš„å¯©æŸ¥æµç¨‹ï¼ŒæŠŠåŸæœ¬å¤ªé«˜çš„é¢¨éšªã€Œé™ã€åˆ°å¯ä»¥æ¥å—çš„ç¯„åœã€‚</li>
                        <li><span class="highlight-green">(D) æ­£ç¢º</span>ï¼š<strong>é¢¨éšªåˆ†æ“”</strong>ã€‚ä¾‹å¦‚è·Ÿ Y å…¬å¸ç°½åˆç´„ï¼Œå¦‚æœä¸å¹¸ç™¼ç”Ÿè³‡æ–™å¤–æ´©ï¼ŒY å…¬å¸è¦è³ å„Ÿï¼›æˆ–æ˜¯å»è²·è³‡å®‰ä¿éšªã€‚æŠŠä¸€éƒ¨åˆ†ç—›è‹¦åˆ†å‡ºå»ã€‚</li>
                    </ul>
                `
            },
            supplement: {
                title: "è§€å¿µè£œå……èˆ‡å»¶ä¼¸",
                content: "é¢¨éšªå›æ‡‰ï¼ˆRisk responseï¼‰æ˜¯è³‡å®‰ç®¡ç†çš„å››å¤§ç­–ç•¥ï¼Œæ ¸å¿ƒç²¾ç¥æ˜¯ã€Œä¾æ“šé¢¨éšªè©•é‘‘çš„çµæœï¼Œæ±ºå®šå¦‚ä½•è™•ç†é¢¨éšªã€ã€‚ä¸¦æ²’æœ‰çµ•å°æœ€å¥½çš„ç­–ç•¥ï¼Œåªæœ‰ã€Œç•¶ä¸‹æœ€åˆé©ã€çš„ç­–ç•¥ã€‚"
            },
            mnemonic: {
                title: "è¨˜æ†¶å£è¨£",
                content: "ã€Œè¦é¨è»Šï¼ˆè¦åšï¼‰å°±ä¸èƒ½ä¸å‡ºé–€ï¼ˆéè¦é¿ï¼‰ï¼Œå«Œå±éšªï¼ˆè¶…èƒƒç´ï¼‰å°±æˆ´å®‰å…¨å¸½ï¼ˆç·©è§£ï¼‰æˆ–è²·ä¿éšªï¼ˆåˆ†æ“”ï¼‰ã€‚ã€"
            },
            trap: {
                title: "å¸¸è¦‹é™·é˜±",
                content: "è¨±å¤šåŒå­¸çœ‹åˆ°ã€Œæ±ºå®šåˆä½œã€ï¼Œæœƒèª¤ä»¥ç‚ºã€Œé‚£å°±æ˜¯æ¥å—é¢¨éšªäº†ã€ï¼Œå› è€Œé¸ (B) é¢¨éšªä¿ç•™ã€‚éŒ¯ï¼æ¥å—ã€Œåˆä½œé€™ä»¶äº‹ã€ä¸ä»£è¡¨æ¥å—ã€Œç„¡é˜²è­·çš„è£¸å¥”ã€ã€‚æ­£æ˜¯å› ç‚ºæ±ºå®šåˆä½œä¸”é¢¨éšªå¤ªé«˜ï¼Œæ‰æ›´éœ€è¦è™•ç†ï¼ˆç·©è§£/åˆ†æ“”ï¼‰ã€‚"
            },
            conclusion: {
                title: "æ­£ç¢ºç­”æ¡ˆ",
                content: "<strong>(C)ã€(D)</strong>"
            }
        },
        selfCheck: [
            {
                question: "1. è‹¥å…¬å¸è©•ä¼°å¾Œæ±ºå®šã€Œä¸èˆ‡ Y å…¬å¸åˆä½œã€ï¼Œå› ç‚ºå¤ªå±éšªäº†ã€‚é€™å±¬æ–¼å“ªä¸€ç¨®é¢¨éšªå›æ‡‰ç­–ç•¥ï¼Ÿ",
                answer: "<strong>é¢¨éšªè¦é¿ï¼ˆRisk avoidanceï¼‰</strong>ã€‚<br>å› ç‚ºå…¬å¸é¸æ“‡ç›´æ¥ä¸­æ­¢æˆ–æ¶ˆé™¤å°è‡´é¢¨éšªçš„æ´»å‹•ï¼ˆä¸åˆä½œï¼‰ï¼Œå¾¹åº•é¿é–‹äº†é¢¨éšªã€‚"
            },
            {
                question: "2. è«‹å„èˆ‰ä¸€å€‹ã€Œé¢¨éšªç·©è§£ã€èˆ‡ã€Œé¢¨éšªåˆ†æ“”ã€åœ¨å§”å¤–åˆä½œä¸­çš„å¯¦éš›ä¾‹å­ã€‚",
                answer: "<strong>é¢¨éšªç·©è§£</strong>ï¼šè¦æ±‚å§”å¤–å» å•†å®šæœŸé€²è¡Œå¼±é»æƒæã€é™åˆ¶å» å•†é€£ç·šæ¬Šé™ï¼ˆé™ä½ç™¼ç”Ÿæ©Ÿç‡/è¡æ“Šï¼‰ã€‚<br><strong>é¢¨éšªåˆ†æ“”</strong>ï¼šåœ¨åˆç´„ä¸­æ˜è¨‚è³‡å®‰äº‹æ•…è³ å„Ÿæ¢æ¬¾ã€è³¼è²·è³‡è¨Šå®‰å…¨ä¿éšªï¼ˆå°‡è²¡å‹™æå¤±è½‰å«ï¼‰ã€‚"
            },
            {
                question: "3. ä»€éº¼æƒ…æ³ä¸‹ï¼Œå…¬å¸å¯ä»¥é¸æ“‡ã€Œé¢¨éšªä¿ç•™ã€ï¼Ÿå¿…é ˆç¬¦åˆå“ªå€‹å‰ææ¢ä»¶ï¼Ÿ",
                answer: "ç•¶é¢¨éšªè©•é‘‘çµæœé¡¯ç¤ºé¢¨éšªç­‰ç´š<strong>ã€Œä½æ–¼ã€</strong>é¢¨éšªèƒƒç´ï¼Œæˆ–æ˜¯è™•ç†è©²é¢¨éšªçš„æˆæœ¬é é«˜æ–¼é¢¨éšªé€ æˆçš„æå¤±æ™‚ï¼Œå…¬å¸å¯é¸æ“‡ä¸»å‹•æ‰¿æ“”é¢¨éšªï¼ˆä¿ç•™ï¼‰ã€‚"
            }
        ],
        glossary: [
            { term: "é¢¨éšªèƒƒç´ (Risk appetite)", desc: "çµ„ç¹”ç‚ºäº†é”æˆç›®æ¨™ï¼Œåœ¨è¿½æ±‚åƒ¹å€¼çš„éç¨‹ä¸­ï¼Œé¡˜æ„ä¸”æœ‰èƒ½åŠ›æ‰¿æ“”çš„é¢¨éšªç¸½é‡æˆ–æ°´æº–ã€‚ç°¡å–®èªªå°±æ˜¯ã€Œå…¬å¸èƒ½å®¹å¿å¤šå¤§çš„å±éšªã€ã€‚" },
            { term: "é¢¨éšªè¦é¿ (Risk avoidance)", desc: "æ±ºå®šä¸æ¶‰å…¥æˆ–ç™»å‡ºé¢¨éšªæ´»å‹•ã€‚ä¾‹å¦‚ï¼šæ€•ç©ºé›£æ‰€ä»¥ä¸æ­é£›æ©Ÿã€æ€•è¢«é§­å®¢æ”»æ“Šæ‰€ä»¥æ‹”æ‰ç¶²è·¯ç·šã€‚" },
            { term: "é¢¨éšªä¿ç•™ (Risk retention)", desc: "æ¥å—é¢¨éšªçš„ç¾ç‹€ï¼Œä¸æ¡å–ä»»ä½•ç©æ¥µçš„æ§åˆ¶æªæ–½ã€‚é€šå¸¸é‡å°ä½é¢¨éšªï¼Œæˆ–è™•ç†æˆæœ¬å¤ªé«˜çš„é¢¨éšªã€‚" },
            { term: "é¢¨éšªç·©è§£ (Risk mitigation)", desc: "æ¡å–æ§åˆ¶æªæ–½ä¾†é™ä½é¢¨éšªç™¼ç”Ÿçš„ã€Œå¯èƒ½æ€§ã€æˆ–ã€Œè¡æ“Šå½±éŸ¿ã€ã€‚é€™æ˜¯è³‡å®‰æœ€å¸¸è¦‹çš„åšæ³•ï¼ˆä¾‹å¦‚è£é˜²æ¯’ã€è¨­é˜²ç«ç‰†ï¼‰ã€‚" },
            { term: "é¢¨éšªåˆ†æ“” (Risk sharing)", desc: "ä¹Ÿç¨±ç‚ºé¢¨éšªè½‰ç§» (Transfer)ï¼Œå°‡é¢¨éšªçš„è²¬ä»»æˆ–æå¤±è½‰å«çµ¦ç¬¬ä¸‰æ–¹ã€‚ä¾‹å¦‚ä¿éšªã€å§”å¤–åˆç´„ä¸­çš„è³ å„Ÿæ¢æ¬¾ã€‚" },
            { term: "é¢¨éšªå›æ‡‰ (Risk response)", desc: "é¢¨éšªç®¡ç†æµç¨‹ä¸­ï¼Œé‡å°è©•é‘‘å‡ºçš„é¢¨éšªæ±ºå®šè™•ç†æ–¹å¼çš„æ­¥é©Ÿã€‚" }
        ]
    };

    // ---------------------------------------------------------
    // Render Functions
    // ---------------------------------------------------------

    function renderQuestion() {
        const qContainer = document.getElementById('question-text');
        qContainer.innerHTML = '';
        
        questionData.textSegments.forEach(seg => {
            const span = document.createElement('span');
            span.textContent = seg.text;
            if (seg.type === 'keyword') {
                span.classList.add('keyword');
                span.title = 'é»æ“Šæ¨™è¨˜/å–æ¶ˆé‡é»';
                span.onclick = function() {
                    this.classList.toggle('active');
                };
            }
            qContainer.appendChild(span);
        });
    }

    function renderOptions() {
        const optContainer = document.getElementById('options-container');
        optContainer.innerHTML = '';

        questionData.options.forEach(opt => {
            const label = document.createElement('label');
            label.className = 'option-label';
            
            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.name = 'answer';
            checkbox.value = opt.id;
            checkbox.id = `opt-${opt.id}`;

            const textSpan = document.createElement('span');
            textSpan.textContent = `(${opt.id}) ${opt.text}`;

            label.appendChild(checkbox);
            label.appendChild(textSpan);
            optContainer.appendChild(label);
        });
    }

    function renderAnalysis() {
        const container = document.getElementById('analysis-content');
        const data = questionData.analysis;
        
        // Helper to create sections
        const createSection = (title, content, isStep = false) => {
            const div = document.createElement('div');
            div.className = isStep ? 'step-block' : 'step-block';
            div.style.borderLeftColor = isStep ? 'var(--accent-color)' : 'var(--success-color)';
            div.innerHTML = `<strong>${title}</strong><div>${content}</div>`;
            return div;
        };

        container.appendChild(createSection(data.step1.title, data.step1.content, true));
        container.appendChild(createSection(data.step2.title, data.step2.content, true));
        container.appendChild(createSection(data.step3.title, data.step3.content, true));
        container.appendChild(createSection(data.step4.title, data.step4.content, true));
        
        container.appendChild(document.createElement('hr'));
        
        container.appendChild(createSection(data.supplement.title, data.supplement.content));
        container.appendChild(createSection(data.mnemonic.title, data.mnemonic.content));
        
        const trapDiv = createSection(data.trap.title, data.trap.content);
        trapDiv.style.borderLeftColor = 'var(--error-color)'; // Red border for trap
        container.appendChild(trapDiv);

        container.appendChild(createSection(data.conclusion.title, data.conclusion.content));
    }

    function renderSelfCheck() {
        const container = document.getElementById('self-check-container');
        questionData.selfCheck.forEach((item, index) => {
            const wrap = document.createElement('div');
            wrap.style.marginBottom = '20px';
            
            const qP = document.createElement('p');
            qP.style.fontWeight = 'bold';
            qP.textContent = item.question;
            
            const btn = document.createElement('button');
            btn.className = 'spoiler-btn';
            btn.textContent = 'é¡¯ç¤ºè§£æ';
            
            const ansDiv = document.createElement('div');
            ansDiv.className = 'spoiler-content';
            ansDiv.innerHTML = item.answer;

            btn.onclick = () => {
                const isHidden = ansDiv.style.display === 'none' || ansDiv.style.display === '';
                ansDiv.style.display = isHidden ? 'block' : 'none';
                btn.textContent = isHidden ? 'éš±è—è§£æ' : 'é¡¯ç¤ºè§£æ';
            };

            wrap.appendChild(qP);
            wrap.appendChild(btn);
            wrap.appendChild(ansDiv);
            container.appendChild(wrap);
        });
    }

    function renderGlossary() {
        const container = document.getElementById('glossary-container');
        questionData.glossary.forEach(item => {
            const div = document.createElement('div');
            div.className = 'glossary-item';
            div.innerHTML = `<span class="glossary-term">${item.term}</span>ï¼š${item.desc}`;
            container.appendChild(div);
        });
    }

    // ---------------------------------------------------------
    // Logic Functions
    // ---------------------------------------------------------

    function checkAnswer() {
        const checkboxes = document.querySelectorAll('input[name="answer"]:checked');
        const selected = Array.from(checkboxes).map(cb => cb.value).sort();
        const correct = questionData.correctAnswers.sort();
        
        const feedback = document.getElementById('feedback-area');
        const analysisSection = document.getElementById('analysis-section');
        const submitBtn = document.getElementById('submit-btn');

        // Simple array comparison
        const isCorrect = JSON.stringify(selected) === JSON.stringify(correct);

        feedback.className = isCorrect ? 'feedback success' : 'feedback error';
        
        if (isCorrect) {
            feedback.innerHTML = 'ğŸ‰ ç­”å°äº†ï¼<br>ä½ çš„è§€å¿µéå¸¸æ­£ç¢ºã€‚è¶•å¿«å¾€ä¸‹çœ‹çœ‹å®Œæ•´è§£æï¼Œéå›ºè¨˜æ†¶ï¼';
        } else {
            const userAns = selected.length > 0 ? selected.join('ã€') : 'æœªä½œç­”';
            feedback.innerHTML = `âš ï¸ ç­”æ¡ˆä¸å®Œå…¨æ­£ç¢ºå–”ã€‚<br>ä½ é¸æ“‡äº†ï¼š${userAns}<br>æ­£ç¢ºç­”æ¡ˆæ‡‰è©²æ˜¯è¤‡é¸ Cã€Dã€‚<br>è«‹å¾€ä¸‹é–±è®€è§£æï¼Œæ‰¾å‡ºç›²é»ï¼`;
        }

        // Show analysis section
        analysisSection.style.display = 'block';
        analysisSection.scrollIntoView({ behavior: 'smooth', block: 'start' });

        // Mark as answered
        submitBtn.textContent = 'å·²ä½œç­” (å†æ¬¡é€å‡º)';
        submitBtn.classList.add('disabled'); // Optional styling
    }

    // ---------------------------------------------------------
    // Initialization
    // ---------------------------------------------------------
    window.onload = function() {
        renderQuestion();
        renderOptions();
        renderAnalysis();
        renderSelfCheck();
        renderGlossary();

        document.getElementById('submit-btn').addEventListener('click', checkAnswer);
    };

</script>
</body>
</html>